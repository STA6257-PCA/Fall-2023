<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Principal Component Analysis - 5&nbsp; Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./abalone.html" rel="next">
<link href="./methods.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./analysis.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Analysis</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Principal Component Analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataset.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Dataset</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abalone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Abalone</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link active" data-scroll-target="#data-preparation"><span class="header-section-number">5.1</span> Data Preparation</a></li>
  <li><a href="#feature-scaling" id="toc-feature-scaling" class="nav-link" data-scroll-target="#feature-scaling"><span class="header-section-number">5.2</span> Feature Scaling</a>
  <ul class="collapse">
  <li><a href="#standardization" id="toc-standardization" class="nav-link" data-scroll-target="#standardization"><span class="header-section-number">5.2.1</span> Standardization</a></li>
  </ul></li>
  <li><a href="#pca-requirements" id="toc-pca-requirements" class="nav-link" data-scroll-target="#pca-requirements"><span class="header-section-number">5.3</span> PCA Requirements</a>
  <ul class="collapse">
  <li><a href="#outliers-detection" id="toc-outliers-detection" class="nav-link" data-scroll-target="#outliers-detection"><span class="header-section-number">5.3.1</span> Outliers Detection</a></li>
  <li><a href="#leverage" id="toc-leverage" class="nav-link" data-scroll-target="#leverage"><span class="header-section-number">5.3.2</span> Leverage</a></li>
  <li><a href="#removing-outliers" id="toc-removing-outliers" class="nav-link" data-scroll-target="#removing-outliers"><span class="header-section-number">5.3.3</span> Removing Outliers</a></li>
  <li><a href="#correlations" id="toc-correlations" class="nav-link" data-scroll-target="#correlations"><span class="header-section-number">5.3.4</span> Correlations</a></li>
  </ul></li>
  <li><a href="#full-model-regression" id="toc-full-model-regression" class="nav-link" data-scroll-target="#full-model-regression"><span class="header-section-number">5.4</span> Full Model Regression</a></li>
  <li><a href="#pca-analysis" id="toc-pca-analysis" class="nav-link" data-scroll-target="#pca-analysis"><span class="header-section-number">5.5</span> PCA Analysis</a>
  <ul class="collapse">
  <li><a href="#svd---singular-value-decomposition" id="toc-svd---singular-value-decomposition" class="nav-link" data-scroll-target="#svd---singular-value-decomposition"><span class="header-section-number">5.5.1</span> SVD - Singular Value Decomposition</a></li>
  <li><a href="#pca---elements" id="toc-pca---elements" class="nav-link" data-scroll-target="#pca---elements"><span class="header-section-number">5.5.2</span> PCA - Elements</a></li>
  <li><a href="#loadings-of-first-two-components" id="toc-loadings-of-first-two-components" class="nav-link" data-scroll-target="#loadings-of-first-two-components"><span class="header-section-number">5.5.3</span> Loadings of First Two Components</a></li>
  <li><a href="#pca---cumulative-variance" id="toc-pca---cumulative-variance" class="nav-link" data-scroll-target="#pca---cumulative-variance"><span class="header-section-number">5.5.4</span> PCA - Cumulative Variance</a></li>
  <li><a href="#pca---number-of-principal-components" id="toc-pca---number-of-principal-components" class="nav-link" data-scroll-target="#pca---number-of-principal-components"><span class="header-section-number">5.5.5</span> PCA - Number of Principal Components</a></li>
  </ul></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization"><span class="header-section-number">5.6</span> Visualization</a>
  <ul class="collapse">
  <li><a href="#scree-plot---cumulative-variance-explained" id="toc-scree-plot---cumulative-variance-explained" class="nav-link" data-scroll-target="#scree-plot---cumulative-variance-explained"><span class="header-section-number">5.6.1</span> Scree Plot - Cumulative Variance Explained</a></li>
  <li><a href="#biplot" id="toc-biplot" class="nav-link" data-scroll-target="#biplot"><span class="header-section-number">5.6.2</span> Biplot</a></li>
  <li><a href="#correlation-circle" id="toc-correlation-circle" class="nav-link" data-scroll-target="#correlation-circle"><span class="header-section-number">5.6.3</span> Correlation Circle</a></li>
  <li><a href="#variable-contribution" id="toc-variable-contribution" class="nav-link" data-scroll-target="#variable-contribution"><span class="header-section-number">5.6.4</span> Variable Contribution</a></li>
  </ul></li>
  <li><a href="#model-building" id="toc-model-building" class="nav-link" data-scroll-target="#model-building"><span class="header-section-number">5.7</span> Model Building</a>
  <ul class="collapse">
  <li><a href="#data-splitting-into-training-test-set" id="toc-data-splitting-into-training-test-set" class="nav-link" data-scroll-target="#data-splitting-into-training-test-set"><span class="header-section-number">5.7.1</span> Data Splitting into Training &amp; Test set</a></li>
  <li><a href="#feature-scaling-standardization" id="toc-feature-scaling-standardization" class="nav-link" data-scroll-target="#feature-scaling-standardization"><span class="header-section-number">5.7.2</span> Feature Scaling: Standardization</a></li>
  <li><a href="#applying-pca-to-training-test-sets" id="toc-applying-pca-to-training-test-sets" class="nav-link" data-scroll-target="#applying-pca-to-training-test-sets"><span class="header-section-number">5.7.3</span> Applying PCA to Training &amp; Test sets</a></li>
  <li><a href="#press-predicted-r2-functions" id="toc-press-predicted-r2-functions" class="nav-link" data-scroll-target="#press-predicted-r2-functions"><span class="header-section-number">5.7.4</span> PRESS &amp; Predicted <span class="math inline">\(R^2\)</span> Functions</a></li>
  <li><a href="#pca-full-model-8-principal-components" id="toc-pca-full-model-8-principal-components" class="nav-link" data-scroll-target="#pca-full-model-8-principal-components"><span class="header-section-number">5.7.5</span> PCA Full Model: 8 Principal Components</a></li>
  <li><a href="#visualization-of-uncorrelated-pca-matrix" id="toc-visualization-of-uncorrelated-pca-matrix" class="nav-link" data-scroll-target="#visualization-of-uncorrelated-pca-matrix"><span class="header-section-number">5.7.6</span> Visualization of Uncorrelated PCA Matrix</a></li>
  </ul></li>
  <li><a href="#pca-2-principal-components" id="toc-pca-2-principal-components" class="nav-link" data-scroll-target="#pca-2-principal-components"><span class="header-section-number">5.8</span> PCA: 2 Principal Components</a>
  <ul class="collapse">
  <li><a href="#principal-components-regression" id="toc-principal-components-regression" class="nav-link" data-scroll-target="#principal-components-regression"><span class="header-section-number">5.8.1</span> <strong>Principal Components Regression</strong></a></li>
  <li><a href="#repeated-cross-validation" id="toc-repeated-cross-validation" class="nav-link" data-scroll-target="#repeated-cross-validation"><span class="header-section-number">5.8.2</span> Repeated Cross-Validation</a></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation"><span class="header-section-number">5.8.3</span> Cross-Validation</a></li>
  </ul></li>
  <li><a href="#predictions" id="toc-predictions" class="nav-link" data-scroll-target="#predictions"><span class="header-section-number">5.9</span> Predictions</a>
  <ul class="collapse">
  <li><a href="#prediction-metrics" id="toc-prediction-metrics" class="nav-link" data-scroll-target="#prediction-metrics"><span class="header-section-number">5.9.1</span> Prediction Metrics</a></li>
  </ul></li>
  <li><a href="#training-conclusion" id="toc-training-conclusion" class="nav-link" data-scroll-target="#training-conclusion"><span class="header-section-number">5.10</span> Training Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Analysis</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="data-preparation" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="data-preparation"><span class="header-section-number">5.1</span> Data Preparation</h2>
<p>In the previous <span class="math inline">\(Dataset\)</span> chapter, we renamed the variables to be more significant, and easier to make inference. Moreover, we imputed the missing values with the Mean.</p>
</section>
<section id="feature-scaling" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="feature-scaling"><span class="header-section-number">5.2</span> Feature Scaling</h2>
<section id="standardization" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="standardization"><span class="header-section-number">5.2.1</span> Standardization</h3>
<p>It is important to Mean-Center the data prior to PCA model building to ensure the first Principal Component is in the direction of maximum variance.</p>
<ul>
<li><p>Standardization produces Mean, <span class="math inline">\(\mu\)</span>= 0, and Variance, <span class="math inline">\(\sigma\)</span> = 1.</p></li>
<li><p>We can rewrite this as:</p>
<p><span class="math display">\[
Z \sim N(0,1)
\]</span></p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the index position of the target feature </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>target_name <span class="ot">&lt;-</span> <span class="st">"expected_survival"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>target_index <span class="ot">&lt;-</span> <span class="fu">grep</span>(target_name, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">colnames</span>(train_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardization Numerical Features</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>train_data_sc <span class="ot">&lt;-</span> <span class="fu">scale</span>(train_data[, <span class="sc">-</span>target_index])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="pca-requirements" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="pca-requirements"><span class="header-section-number">5.3</span> PCA Requirements</h2>
<section id="outliers-detection" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="outliers-detection"><span class="header-section-number">5.3.1</span> Outliers Detection</h3>
<ul>
<li>There are some outliers in the data frame.</li>
<li>However, there are three outliers with no high leverage.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a boxplot to visualize potential outliers</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(train_data_sc, <span class="at">main =</span> <span class="st">"Outliers Detection"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a boxplot</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># train_data_sc %&gt;%  </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   aes(y = train_data_sc) +</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_boxplot() +</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Outliers Detection")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="leverage" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="leverage"><span class="header-section-number">5.3.2</span> Leverage</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(my_seed)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>ordinary_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(expected_survival <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ordinary_model)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual Diagnostics</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_lev</span>(ordinary_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="removing-outliers" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="removing-outliers"><span class="header-section-number">5.3.3</span> Removing Outliers</h3>
<p>After removing one outlier from the dataset, we discovered that the final results produced minimal variability. Therefore, we decided to present a model that captures all the data points’ information; thus, no observations will be removed from the final model.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No Outliers subset</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>no_outliers_df <span class="ot">&lt;-</span> <span class="fu">slice</span>(train_data, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">56</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(my_seed)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>no_outliers_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(expected_survival <span class="sc">~</span> ., <span class="at">data =</span> no_outliers_df)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(no_outliers_model)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual Diagnostics</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_lev</span>(no_outliers_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="correlations" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="correlations"><span class="header-section-number">5.3.4</span> Correlations</h3>
<ul>
<li><p>There are high correlated features.</p></li>
<li><p>Multicollinearity is present in the data set.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlations and round to 2 digits</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(train_data_sc)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">round</span>(corr_matrix, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Print names of highly correlated features; threshold &gt; 0.30</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>high <span class="ot">&lt;-</span> <span class="fu">findCorrelation</span>(corr_matrix, <span class="at">cutoff =</span> <span class="fl">0.30</span>, <span class="at">names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># table format</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(high) <span class="sc">%&gt;%</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-paper lightable-hover table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">expected_transfusion</td>
</tr>
<tr class="even">
<td style="text-align: left;">better_infection</td>
</tr>
<tr class="odd">
<td style="text-align: left;">expected_hospitalization</td>
</tr>
<tr class="even">
<td style="text-align: left;">expected_hospital_readmission</td>
</tr>
<tr class="odd">
<td style="text-align: left;">expected_fistula</td>
</tr>
<tr class="even">
<td style="text-align: left;">prevalent_transplant_waitlist_expected</td>
</tr>
<tr class="odd">
<td style="text-align: left;">incident_transplant_waitlist_expected</td>
</tr>
<tr class="even">
<td style="text-align: left;">expected_infection</td>
</tr>
<tr class="odd">
<td style="text-align: left;">worse_survival</td>
</tr>
<tr class="even">
<td style="text-align: left;">incident_transplant_waitlist_better</td>
</tr>
<tr class="odd">
<td style="text-align: left;">better_hospital_readmission</td>
</tr>
<tr class="even">
<td style="text-align: left;">worse_transfusion</td>
</tr>
<tr class="odd">
<td style="text-align: left;">worse_hospital_readmission</td>
</tr>
<tr class="even">
<td style="text-align: left;">worse_fistula</td>
</tr>
<tr class="odd">
<td style="text-align: left;">incident_transplant_waitlist_worse</td>
</tr>
<tr class="even">
<td style="text-align: left;">better_fistula</td>
</tr>
<tr class="odd">
<td style="text-align: left;">prevalent_transplant_waitlist_better</td>
</tr>
<tr class="even">
<td style="text-align: left;">better_survival</td>
</tr>
<tr class="odd">
<td style="text-align: left;">worse_infection</td>
</tr>
<tr class="even">
<td style="text-align: left;">phosphorus (5.6 - 7) Mg</td>
</tr>
<tr class="odd">
<td style="text-align: left;">prevalent_transplant_waitlist_worse</td>
</tr>
<tr class="even">
<td style="text-align: left;">phosphorus (3.5 - 4.5) Mg</td>
</tr>
<tr class="odd">
<td style="text-align: left;">phosphorus &gt; 7Mg</td>
</tr>
<tr class="even">
<td style="text-align: left;">better_transfusion</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hgb 10g</td>
</tr>
<tr class="even">
<td style="text-align: left;">hypercalcemia_calcium &gt; 10.2Mg</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pediatric_nPCR</td>
</tr>
<tr class="even">
<td style="text-align: left;">long_term_catheter</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="full-model-regression" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="full-model-regression"><span class="header-section-number">5.4</span> Full Model Regression</h2>
<ul>
<li>The Adjusted R^2 = 99.99% is an indication of over-fitting, or bias.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(my_seed)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a multiple linear regression model</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(expected_survival <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print a summary of the regression model</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(full_model, <span class="at">string.p=</span><span class="st">"P-value"</span>, <span class="at">show.se=</span><span class="st">"T"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="4" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">expected_survival</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">std. Error</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">P-value</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">93.71</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">41.88</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">5.73&nbsp;–&nbsp;181.69</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.038</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">better transfusion</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.04</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.75</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.53&nbsp;–&nbsp;2.62</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.181</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">expected transfusion</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.00</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.03</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.07&nbsp;–&nbsp;0.07</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.974</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">worse transfusion</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.13</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.08</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.03&nbsp;–&nbsp;0.29</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.096</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">better infection</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.27</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.09</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.46&nbsp;–&nbsp;-0.07</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.009</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">expected infection</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.04</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.06</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.17&nbsp;–&nbsp;0.09</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.574</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">worse infection</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.11</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.27</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.68&nbsp;–&nbsp;0.46</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.687</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">Kt v 1 2</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.25</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.25</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.28&nbsp;–&nbsp;0.78</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.335</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">Kt v 1 7</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.00</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.05</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.11&nbsp;–&nbsp;0.11</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.996</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">pedriatic Kt v 1 2</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.04</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.03</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.11&nbsp;–&nbsp;0.03</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.241</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">pediatric Kt v 1 8</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.02</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.01</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.04&nbsp;–&nbsp;0.00</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.076</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">pediatric nPCR</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.04</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.03</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.01&nbsp;–&nbsp;0.10</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.097</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">better fistula</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.18</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.11</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.41&nbsp;–&nbsp;0.04</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.101</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">expected fistula</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.01</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.08</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.15&nbsp;–&nbsp;0.16</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.935</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">worse fistula</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.03</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.11</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.25&nbsp;–&nbsp;0.19</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.780</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">long term catheter</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.31</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.07</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.16&nbsp;–&nbsp;0.47</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">hypercalcemia calcium &gt;<br>
10 2Mg</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.19</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.09</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.37&nbsp;–&nbsp;-0.00</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.048</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">phosphorus &lt; 3 5Mg</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.35</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.48</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.66&nbsp;–&nbsp;1.36</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.476</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">phosphorus (3 5 - 4 5) Mg</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.73</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.46</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-2.71&nbsp;–&nbsp;-0.76</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.002</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">phosphorus (4 6 - 5 5) Mg</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.36</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.46</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-2.33&nbsp;–&nbsp;-0.40</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.008</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">phosphorus (5 6 - 7) Mg</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.80</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.44</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.72&nbsp;–&nbsp;0.12</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.085</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">phosphorus &gt; 7Mg</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.44</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.46</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-2.41&nbsp;–&nbsp;-0.48</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.005</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">better hospitalization</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.08</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.32</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.59&nbsp;–&nbsp;0.76</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.797</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">expected hospitalization</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.70</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.15</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.38&nbsp;–&nbsp;1.03</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">worse hospitalization</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.52</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.22</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.05&nbsp;–&nbsp;0.98</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.031</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">better hospital<br>
readmission</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.38</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.24</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.13&nbsp;–&nbsp;0.88</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.139</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">expected hospital<br>
readmission</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.31</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.13</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.03&nbsp;–&nbsp;0.60</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.031</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">worse hospital<br>
readmission</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.09</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.24</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.41&nbsp;–&nbsp;0.59</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.704</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">better survival</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.57</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.15</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.88&nbsp;–&nbsp;-0.27</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">worse survival</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.91</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.14</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.20&nbsp;–&nbsp;-0.62</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">incident transplant<br>
waitlist better</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.01</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.13</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.27&nbsp;–&nbsp;0.29</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.926</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">incident transplant<br>
waitlist expected</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.03</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.04</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.05&nbsp;–&nbsp;0.12</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.421</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">incident transplant<br>
waitlist worse</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.31</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.12</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.06&nbsp;–&nbsp;0.56</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.018</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">prevalent transplant<br>
waitlist better</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.15</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.11</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.08&nbsp;–&nbsp;0.38</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.191</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">prevalent transplant<br>
waitlist expected</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.04</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.10</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.17&nbsp;–&nbsp;0.25</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.690</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">prevalent transplant<br>
waitlist worse</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.01</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.19</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.39&nbsp;–&nbsp;0.40</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.975</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">Hgb 10g</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.10</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.05</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.20&nbsp;–&nbsp;-0.00</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.046</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">Hgb 12g</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.36</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.66</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.75&nbsp;–&nbsp;1.04</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.597</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="4" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">56</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="4" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">1.000 / 1.000</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="pca-analysis" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="pca-analysis"><span class="header-section-number">5.5</span> PCA Analysis</h2>
<section id="svd---singular-value-decomposition" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="svd---singular-value-decomposition"><span class="header-section-number">5.5.1</span> SVD - Singular Value Decomposition</h3>
<p>We will focus on Singular Value Decomposition which is a classic approach for PCA analysis.</p>
<p>Singular Value Decomposition is a factorization technique used in linear algebra to decompose a matrix into three matrices.</p>
<ol type="1">
<li><p>U: A matrix whose columns are the left singular vectors of the original matrix.</p></li>
<li><p>D: A diagonal matrix whose entries are the singular values of the original matrix.</p></li>
<li><p>V: A matrix whose columns are the right singular vectors of the original matrix.</p></li>
</ol>
<p>The SVD is closely related to the eigenvalue decomposition (EVD), which is another factorization technique used in linear algebra. While the EVD can only be applied to square matrices, the SVD can be applied to any matrix, including rectangular matrices. The SVD is also more numerically stable than the EVD, making it a preferred method for many applications.</p>
<ul>
<li>Note: The Spectral Decomposition approach is used with the princomp() function.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply PCA using prcomp()</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>data_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(train_data_sc, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>pca_summ <span class="ot">&lt;-</span> <span class="fu">summary</span>(data_pca)<span class="sc">$</span>importance</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># table format</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(pca_summ) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-paper lightable-hover table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC6</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC7</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC8</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC9</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC10</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC11</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC12</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC13</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC14</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC15</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC16</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC17</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC18</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC19</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC20</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC21</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC22</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC23</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC24</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC25</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC26</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC27</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC28</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC29</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC30</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC31</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC32</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC33</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC34</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC35</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC36</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC37</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Standard deviation</td>
<td style="text-align: right;">3.885383</td>
<td style="text-align: right;">1.87172</td>
<td style="text-align: right;">1.837743</td>
<td style="text-align: right;">1.748684</td>
<td style="text-align: right;">1.422673</td>
<td style="text-align: right;">1.250784</td>
<td style="text-align: right;">1.127957</td>
<td style="text-align: right;">1.093315</td>
<td style="text-align: right;">0.9449088</td>
<td style="text-align: right;">0.9081311</td>
<td style="text-align: right;">0.8185497</td>
<td style="text-align: right;">0.7790474</td>
<td style="text-align: right;">0.6814511</td>
<td style="text-align: right;">0.6366325</td>
<td style="text-align: right;">0.5710251</td>
<td style="text-align: right;">0.5054679</td>
<td style="text-align: right;">0.5017618</td>
<td style="text-align: right;">0.4884469</td>
<td style="text-align: right;">0.4624706</td>
<td style="text-align: right;">0.4169063</td>
<td style="text-align: right;">0.3533773</td>
<td style="text-align: right;">0.3247406</td>
<td style="text-align: right;">0.2883674</td>
<td style="text-align: right;">0.2604156</td>
<td style="text-align: right;">0.2259012</td>
<td style="text-align: right;">0.2149077</td>
<td style="text-align: right;">0.1982033</td>
<td style="text-align: right;">0.166981</td>
<td style="text-align: right;">0.126791</td>
<td style="text-align: right;">0.1091444</td>
<td style="text-align: right;">0.083804</td>
<td style="text-align: right;">0.0509429</td>
<td style="text-align: right;">0.0316654</td>
<td style="text-align: right;">0.0287096</td>
<td style="text-align: right;">0.0143347</td>
<td style="text-align: right;">0.0080567</td>
<td style="text-align: right;">0.0049179</td>
</tr>
<tr class="even">
<td style="text-align: left;">Proportion of Variance</td>
<td style="text-align: right;">0.408010</td>
<td style="text-align: right;">0.09468</td>
<td style="text-align: right;">0.091280</td>
<td style="text-align: right;">0.082650</td>
<td style="text-align: right;">0.054700</td>
<td style="text-align: right;">0.042280</td>
<td style="text-align: right;">0.034390</td>
<td style="text-align: right;">0.032310</td>
<td style="text-align: right;">0.0241300</td>
<td style="text-align: right;">0.0222900</td>
<td style="text-align: right;">0.0181100</td>
<td style="text-align: right;">0.0164000</td>
<td style="text-align: right;">0.0125500</td>
<td style="text-align: right;">0.0109500</td>
<td style="text-align: right;">0.0088100</td>
<td style="text-align: right;">0.0069100</td>
<td style="text-align: right;">0.0068000</td>
<td style="text-align: right;">0.0064500</td>
<td style="text-align: right;">0.0057800</td>
<td style="text-align: right;">0.0047000</td>
<td style="text-align: right;">0.0033800</td>
<td style="text-align: right;">0.0028500</td>
<td style="text-align: right;">0.0022500</td>
<td style="text-align: right;">0.0018300</td>
<td style="text-align: right;">0.0013800</td>
<td style="text-align: right;">0.0012500</td>
<td style="text-align: right;">0.0010600</td>
<td style="text-align: right;">0.000750</td>
<td style="text-align: right;">0.000430</td>
<td style="text-align: right;">0.0003200</td>
<td style="text-align: right;">0.000190</td>
<td style="text-align: right;">0.0000700</td>
<td style="text-align: right;">0.0000300</td>
<td style="text-align: right;">0.0000200</td>
<td style="text-align: right;">0.0000100</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cumulative Proportion</td>
<td style="text-align: right;">0.408010</td>
<td style="text-align: right;">0.50269</td>
<td style="text-align: right;">0.593970</td>
<td style="text-align: right;">0.676610</td>
<td style="text-align: right;">0.731320</td>
<td style="text-align: right;">0.773600</td>
<td style="text-align: right;">0.807990</td>
<td style="text-align: right;">0.840290</td>
<td style="text-align: right;">0.8644200</td>
<td style="text-align: right;">0.8867100</td>
<td style="text-align: right;">0.9048200</td>
<td style="text-align: right;">0.9212200</td>
<td style="text-align: right;">0.9337800</td>
<td style="text-align: right;">0.9447300</td>
<td style="text-align: right;">0.9535400</td>
<td style="text-align: right;">0.9604500</td>
<td style="text-align: right;">0.9672500</td>
<td style="text-align: right;">0.9737000</td>
<td style="text-align: right;">0.9794800</td>
<td style="text-align: right;">0.9841800</td>
<td style="text-align: right;">0.9875500</td>
<td style="text-align: right;">0.9904000</td>
<td style="text-align: right;">0.9926500</td>
<td style="text-align: right;">0.9944800</td>
<td style="text-align: right;">0.9958600</td>
<td style="text-align: right;">0.9971100</td>
<td style="text-align: right;">0.9981700</td>
<td style="text-align: right;">0.998930</td>
<td style="text-align: right;">0.999360</td>
<td style="text-align: right;">0.9996800</td>
<td style="text-align: right;">0.999870</td>
<td style="text-align: right;">0.9999400</td>
<td style="text-align: right;">0.9999700</td>
<td style="text-align: right;">0.9999900</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">1.0000000</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="pca---elements" class="level3" data-number="5.5.2">
<h3 data-number="5.5.2" class="anchored" data-anchor-id="pca---elements"><span class="header-section-number">5.5.2</span> PCA - Elements</h3>
<ul>
<li><p>The values in <strong><code>data_pca$x</code></strong> are the coordinates of each observation in the new principal component space. These coordinates are the scores for each observation along each principal component.</p></li>
<li><p>The eigenvectors of the covariance or correlation matrix of the data represent the directions of maximum variance or information in the dataset.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Principal Component scores vector</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>pc_scores <span class="ot">&lt;-</span> data_pca<span class="sc">$</span>x</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Std Deviation of Components</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>component_sdev <span class="ot">&lt;-</span> data_pca<span class="sc">$</span>sdev</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Eigenvector, or Loadings</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>eigenvector <span class="ot">&lt;-</span> data_pca<span class="sc">$</span>rotation</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean of variables</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>component_mean <span class="ot">&lt;-</span> data_pca<span class="sc">$</span>center </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Scaling factor of Variables</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>component_scale <span class="ot">&lt;-</span> data_pca<span class="sc">$</span>scale</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="loadings-of-first-two-components" class="level3" data-number="5.5.3">
<h3 data-number="5.5.3" class="anchored" data-anchor-id="loadings-of-first-two-components"><span class="header-section-number">5.5.3</span> Loadings of First Two Components</h3>
<ul>
<li>The loading are the weights assigned to each variable for that particular principal component.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Access the loadings for the first two principal components</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>loadings_first_two_components <span class="ot">&lt;-</span> eigenvector[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the loadings for the first two principal components</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Loadings for the first two principal components:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Loadings for the first two principal components:"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(loadings_first_two_components)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                 PC1          PC2
better_transfusion                      0.0505988170  0.015071362
expected_transfusion                    0.2535655387 -0.021428805
worse_transfusion                       0.2058083243 -0.164735938
better_infection                        0.2526036797 -0.007341849
expected_infection                      0.2455149674 -0.065172327
worse_infection                         0.1381076997  0.063702113
Kt_v_1.2                                0.0030888370  0.008117565
Kt_v_1.7                               -0.0077627944  0.044354338
pedriatic_Kt_v_1.2                     -0.0635839673  0.052731221
pediatric_Kt_v_1.8                     -0.0139161654  0.002781654
pediatric_nPCR                         -0.0394255772  0.076824152
better_fistula                          0.1701351094  0.184888641
expected_fistula                        0.2521168144 -0.055750964
worse_fistula                           0.1932023133 -0.048145074
long_term_catheter                     -0.0054339687  0.040853832
hypercalcemia_calcium &gt; 10.2Mg         -0.0276031313  0.104909219
phosphorus &lt; 3.5Mg                      0.0161465158  0.375887922
phosphorus (3.5 - 4.5) Mg               0.0419719997  0.425799543
phosphorus (4.6 - 5.5) Mg               0.0888141257  0.266545080
phosphorus (5.6 - 7) Mg                -0.0954250049 -0.329731283
phosphorus &gt; 7Mg                       -0.0293097443 -0.439982654
better_hospitalization                  0.1554828676  0.039769206
expected_hospitalization                0.2534938280 -0.035294582
worse_hospitalization                   0.1862740734 -0.104759047
better_hospital_readmission             0.2100006566 -0.046207863
expected_hospital_readmission           0.2537238605 -0.041416989
worse_hospital_readmission              0.2009955081 -0.043217623
better_survival                         0.1522860091  0.168831835
worse_survival                          0.2288119832 -0.066222930
incident_transplant_waitlist_better     0.2015728228  0.151287289
incident_transplant_waitlist_expected   0.2498798110 -0.057824581
incident_transplant_waitlist_worse      0.1912997762 -0.019853974
prevalent_transplant_waitlist_better    0.1617720280  0.176291623
prevalent_transplant_waitlist_expected  0.2500769232 -0.070274998
prevalent_transplant_waitlist_worse     0.1201730964 -0.228472026
Hgb 10g                                -0.0298792287 -0.080370928
Hgb 12g                                -0.0005836729  0.176481318</code></pre>
</div>
</div>
</section>
<section id="pca---cumulative-variance" class="level3" data-number="5.5.4">
<h3 data-number="5.5.4" class="anchored" data-anchor-id="pca---cumulative-variance"><span class="header-section-number">5.5.4</span> PCA - Cumulative Variance</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion of variance explained by each PC</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>variance_explained <span class="ot">&lt;-</span> component_sdev<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(component_sdev<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cumulative proportion of variance explained</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>cumulative_variance_explained <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(variance_explained)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>cumulative_variance_explained</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.4080054 0.5026901 0.5939685 0.6766143 0.7313169 0.7735996 0.8079857
 [8] 0.8402922 0.8644234 0.8867126 0.9048213 0.9212244 0.9337751 0.9447292
[15] 0.9535419 0.9604473 0.9672517 0.9736998 0.9794804 0.9841779 0.9875530
[22] 0.9904031 0.9926506 0.9944835 0.9958627 0.9971109 0.9981727 0.9989263
[29] 0.9993607 0.9996827 0.9998725 0.9999427 0.9999698 0.9999920 0.9999976
[36] 0.9999993 1.0000000</code></pre>
</div>
</div>
</section>
<section id="pca---number-of-principal-components" class="level3" data-number="5.5.5">
<h3 data-number="5.5.5" class="anchored" data-anchor-id="pca---number-of-principal-components"><span class="header-section-number">5.5.5</span> PCA - Number of Principal Components</h3>
<ul>
<li>We conclude that 9 Principal Components explain 86% of the variance.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retain components that explain a percentage of the variance</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>num_components <span class="ot">&lt;-</span> <span class="fu">which</span>(cumulative_variance_explained <span class="sc">&gt;=</span> <span class="fl">0.86</span>)[<span class="dv">1</span>]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the desired number of principal components</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>selected_pcs <span class="ot">&lt;-</span> pc_scores[, <span class="dv">1</span><span class="sc">:</span>num_components]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>selected_pcs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          PC1          PC2         PC3          PC4         PC5         PC6
1  -3.1377897  0.771802333 -0.73643610 -0.922235383 -0.35927448  0.38542561
2   0.9108769 -1.373614712 -0.89066560 -0.046036426  0.02278572  0.32672341
3  -1.3650210 -1.765641978 -0.14492292  0.259189212 -1.28569119 -0.37616348
4  -3.0594171  0.334783454 -0.01406268 -0.139540012  0.09202588 -0.28246147
5  -0.1990728 -0.207347300 -0.71486169 -1.375622870 -1.19927381  0.03193723
6  15.2031917  2.618707806 -7.73627571  4.051949166 -0.82443732 -2.82184549
7  -1.1596436  1.121551314 -0.71119818 -0.684236835  0.22859575 -0.38210147
8  -1.7566946  2.446404457  0.23358063 -0.787124212 -0.10982171 -1.06033591
9  -2.5604524  1.078492112 -0.02070808 -0.001800478 -0.24737807  1.19300909
10 -2.2725299  0.767002717 -0.05524655 -1.004506232  2.44302298 -1.80923423
11 10.2100889 -3.095058992  5.56314501 -2.707865857 -3.23281430 -1.47878094
12  5.1285806 -1.770508028  1.78490237 -0.162837263  0.51758150 -0.36715154
13 -3.4958456 -4.420614532 -3.14253662  0.040387883 -0.79275740  0.42165629
14 -1.7133698  0.822955825 -1.96628840 -1.087070858  0.75045171  0.43567043
15 -1.9510677  0.907515363 -0.34586585 -1.470709937 -0.77348447 -0.78101531
16 -2.6295662  0.914891571 -0.52633428 -1.348424988 -0.93480439  0.51812412
17  4.7463371  0.314584946  2.37090668 -0.252790732  0.83290377  1.42903927
18  0.3868186 -0.929048000  0.68704793 -0.611740653  1.53736445 -0.11125974
19 -1.6766975  0.284981397 -0.98417172 -1.813309386 -0.81355933  0.75181767
20 -0.7344809 -1.322183158  0.37001336 -0.844751806  2.05528745 -1.60184302
21  0.9392629 -0.699900216 -0.13989705 -0.597819034 -0.02027423 -0.00460663
22 -0.8326091  1.587389983 -0.73121315  0.290973848  0.11987111  1.10998873
23  0.8724526  1.045058855  0.27746739  0.217533123 -0.62257760  0.54288629
24 -2.7729541  0.532823236 -0.38569030 -0.934135557  0.89428334 -2.72370097
25  2.0146426  0.001409232  0.64033906 -0.692861288 -0.16774408  0.45551037
26 -1.1376241  0.667578303  0.06120837  0.244365584 -0.44647286  0.92651259
27  0.1255818 -0.995109875  1.15033009 -0.489711370  0.71084468  1.38539681
28 -3.6485929 -5.124718566  0.04913529  6.332224295 -1.44380969  1.47256020
29 -0.3307121  0.279250049 -0.09852864 -0.338816118 -0.59497247 -0.57611719
30 -3.1386137 -2.484679699 -2.00441012  1.066087068 -0.58765600 -0.02923877
31  1.8304255 -0.865860455 -0.62921128 -0.288806050 -0.35848754  1.15223519
32 -2.6299851  1.882042739  1.47902941  1.519749388  0.14837356  0.99433001
33 -1.9654200  1.443737323  0.42388464 -1.421726497  0.34517137  0.14894489
34 -2.9433777 -0.445332786 -0.18685858  0.050108988 -0.34712485 -0.38836224
35  1.9334685  4.227422253 -1.54289340 -0.835373008 -0.54123998  2.37389028
36 -1.4611450  0.555081258 -1.44670031 -0.273171460  0.41677320 -0.33354615
37 -1.6820407 -0.925297600 -0.31774506 -0.273721372 -0.78520268  0.20360927
38  6.7594616  3.638815421  1.05618063  2.351356035  2.49702755  3.43721377
39  3.4506790 -1.182398955  2.56989757 -1.112911235 -0.05458367  1.43612628
40 -1.0983772 -1.524068762 -0.53200487 -0.477669191 -0.99945377 -0.80297280
41 -1.9193470 -0.016455120 -1.08062219 -0.587236913 -0.63239954 -0.20135310
42  3.4962356  1.519916753  1.31092517 -0.300656841  2.59852281  1.04990713
43 -0.2522021  3.071775273  2.14067078 -1.925517343 -2.27190695 -3.40926804
44 -3.0134705 -0.685824171 -1.17123942 -0.855106884 -0.44275792  0.83905452
45  0.3392488 -0.513300425  0.03908522 -0.176642934 -0.59240146  1.05933117
46 -2.1136312  2.610044185  0.53298151 -0.847818228  0.07520510  0.14163876
47  1.3706778 -2.910358069  1.08475124  1.316261684  6.13811703 -2.14363119
48 13.0708364 -2.725721891  0.42574820 -0.475180731 -0.78335087  0.57890473
49 -2.6464920 -0.380710708 -0.69436207  1.036469413 -0.92018764  0.45363960
50  1.7504813 -0.179844084 -0.26891623 -0.341129747  0.60754876 -0.77667306
51 -3.3724826  3.536458694  5.32705688  7.762674701 -2.31626791 -1.79609628
52 -3.1242143 -1.042445343  0.80437184  2.133119681  2.85592676 -0.90733360
53 -1.0176612 -1.671769226 -1.82862519  0.394960511 -0.46534146  0.86157778
54 -0.3396014  0.750547277  0.95957147 -0.301395219  0.57260088  0.01894730
55 -2.2360197 -0.655876540  0.77645594  0.231805497 -0.27848656 -0.34479229
56 -3.1511256  0.180665062 -1.07019444 -0.491205128 -0.21428914 -0.62572389
           PC7         PC8         PC9
1   1.76446455  0.71374642 -1.27763836
2   1.90946042  0.32026834  0.31575168
3  -0.78560815 -0.92036817 -1.26256359
4  -0.12860754  0.13732138  0.07796673
5   0.74994371  0.71599423 -0.19541169
6  -0.39368588  0.75396577  0.12358783
7  -0.51476890 -1.37312839  0.55597712
8  -0.14340022 -1.64114704  1.14619211
9  -0.12337260  1.64840877  1.12228458
10  1.30112932  0.04017681  0.78534979
11 -1.01949796  0.39458663  0.01823775
12  1.27365641  0.38385941 -0.19143125
13  0.10866259 -1.13950353 -1.57906009
14  1.10103413  0.88533889 -1.19056845
15 -1.01157314 -1.47740924  0.22146676
16  0.35695340  0.88633035 -0.44875630
17 -0.84922663  0.01277585 -0.04793206
18  0.22648544  0.76907240 -0.83845390
19  0.84498090 -0.26045393  0.78929137
20  0.75707090 -1.18661916  1.67512391
21  1.31702137  0.49437991  0.47455077
22 -1.64549969  1.13118828 -0.04484940
23 -0.21184648  0.96993606  1.61645155
24 -0.47378261 -2.62659005  1.14510308
25 -0.38399443  0.27541717  1.00447793
26 -0.69664564  0.94135363  0.17566660
27  0.02791903 -0.36150463 -0.45207374
28 -0.77192847 -0.90604294  2.92091797
29  2.01369673  0.05235085  0.94851213
30 -0.76889273 -0.04319356 -0.93018809
31  1.40987972 -0.23868533  0.11171350
32  1.01379575  1.75474773 -0.29044327
33  0.22672970  0.82917850  0.05368812
34 -1.84413987  0.45197913  0.38530687
35 -0.29186460  0.24777941  0.05260103
36  0.03060274  1.07595713 -0.12917118
37 -0.46866588  0.53016534 -0.43879593
38 -1.42758292 -3.60748873 -1.60176642
39 -0.65914865 -1.03448059 -0.16051740
40 -0.19504945 -1.60842789 -0.69636619
41 -1.31580368 -1.30270411  0.17184914
42 -0.23125332 -0.09689562  0.84640868
43 -2.15443994  0.22710813 -1.25870358
44 -1.00388333  0.40847078 -0.11206689
45  1.16629583  0.52067375 -0.32481693
46  1.09265840 -0.35878735  1.34775109
47  0.97170555  0.19459095 -1.28733565
48  0.96197055  0.51964456 -0.22818731
49  0.21464465 -0.60479462 -0.75320369
50 -0.00577914  0.27805102  1.52332281
51  2.17235909 -0.18750827 -1.11305739
52 -3.95021078  3.06573217 -0.25289702
53 -0.24568069 -0.17110049 -0.38166238
54 -0.04332971  0.06369494  0.62713705
55 -0.03710043  0.79675151 -1.07516939
56  0.78314261 -1.34416256 -1.67360042</code></pre>
</div>
</div>
</section>
</section>
<section id="visualization" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="visualization"><span class="header-section-number">5.6</span> Visualization</h2>
<section id="scree-plot---cumulative-variance-explained" class="level3" data-number="5.6.1">
<h3 data-number="5.6.1" class="anchored" data-anchor-id="scree-plot---cumulative-variance-explained"><span class="header-section-number">5.6.1</span> Scree Plot - Cumulative Variance Explained</h3>
<ul>
<li><p>PC1 explains 40.8% variance.</p></li>
<li><p>PC2 explains 9.5% variance.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(data_pca, <span class="at">addlabels =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="biplot" class="level3" data-number="5.6.2">
<h3 data-number="5.6.2" class="anchored" data-anchor-id="biplot"><span class="header-section-number">5.6.2</span> Biplot</h3>
<p>The correlation between a variable and a principal component (PC) is used as the coordinates of the variable on the PC. The representation of variables differs from the plot of the observations: The observations are represented by their projections, but the variables are represented by their correlations&nbsp;(Abdi and Williams 2010).</p>
<ul>
<li><p>PC1 is represented in black which displays the longest distance of its projection.</p></li>
<li><p>PC2 is represented in blue which displays a shorter distance as expected.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(data_pca, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">"point"</span>, <span class="st">"arrow"</span>),</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom.var =</span> <span class="st">"arrow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="correlation-circle" class="level3" data-number="5.6.3">
<h3 data-number="5.6.3" class="anchored" data-anchor-id="correlation-circle"><span class="header-section-number">5.6.3</span> Correlation Circle</h3>
<p>The plot below is also known as variable correlation plots. It shows the relationships between all variables. It can be interpreted as follow:</p>
<ul>
<li><p>Positively correlated variables are grouped together.</p></li>
<li><p>Negatively correlated variables are positioned on opposite sides of the plot origin (opposed quadrants).</p></li>
<li><p>The distance between variables and the origin measures the quality of the variables on the factor map. Variables that are away from the origin are well represented on the factor map.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Control variable colors using their contributions</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(data_pca, <span class="at">col.var =</span> <span class="st">"contrib"</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">geom.var =</span> <span class="st">"arrow"</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>   <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="variable-contribution" class="level3" data-number="5.6.4">
<h3 data-number="5.6.4" class="anchored" data-anchor-id="variable-contribution"><span class="header-section-number">5.6.4</span> Variable Contribution</h3>
<p>Top variable contribution for the first two principal components.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contributions of variables to PC1</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>pc2_contribution <span class="ot">&lt;-</span> <span class="fu">fviz_contrib</span>(data_pca, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">1</span>, <span class="at">top =</span> <span class="dv">20</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify the theme to rotate X-axis labels to 90 degrees</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>pc2_contribution <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)  <span class="co"># horizontal justification</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Contribution of Variables to PC1"</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage Contribution"</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"PC1 explains 40.8% variance"</span>) <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">1</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">accuracy =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contributions of variables to PC2</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>pc2_contribution <span class="ot">&lt;-</span> <span class="fu">fviz_contrib</span>(data_pca, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">2</span>, <span class="at">top =</span> <span class="dv">12</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify the theme to rotate X-axis labels to 90 degrees</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>pc2_contribution <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)  <span class="co"># horizontal justification</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Contribution of Variables to PC2"</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage Contribution"</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"PC2 explains 9.5% variance"</span>) <span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">1</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">accuracy =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="model-building" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="model-building"><span class="header-section-number">5.7</span> Model Building</h2>
<section id="data-splitting-into-training-test-set" class="level3" data-number="5.7.1">
<h3 data-number="5.7.1" class="anchored" data-anchor-id="data-splitting-into-training-test-set"><span class="header-section-number">5.7.1</span> Data Splitting into Training &amp; Test set</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reproducible random sampling</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(my_seed)  </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Target y-variable for the training set</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> train_data<span class="sc">$</span>expected_survival  </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and test sets </span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(y, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>) </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>training_set <span class="ot">&lt;-</span> <span class="fu">subset</span>(train_data, split <span class="sc">==</span> <span class="cn">TRUE</span>) </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>test_set <span class="ot">&lt;-</span> <span class="fu">subset</span>(train_data, split <span class="sc">==</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="feature-scaling-standardization" class="level3" data-number="5.7.2">
<h3 data-number="5.7.2" class="anchored" data-anchor-id="feature-scaling-standardization"><span class="header-section-number">5.7.2</span> Feature Scaling: Standardization</h3>
<ul>
<li>Standardization ensures all features are on the same scale, and this method is less sensitive to outliers.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature Scaling: Standardization</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform centering and scaling on the training and test sets</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>sc <span class="ot">&lt;-</span> <span class="fu">preProcess</span>(training_set[, <span class="sc">-</span>target_index], </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>))</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>training_set[, <span class="sc">-</span>target_index] <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  sc, training_set[, <span class="sc">-</span>target_index])</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>test_set[, <span class="sc">-</span>target_index] <span class="ot">&lt;-</span> <span class="fu">predict</span>(sc, test_set[, <span class="sc">-</span>target_index])</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co"># training_set[,-target_index] = scale(training_set[, -target_index])</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># test_set[,-target_index] = scale(test_set[, -target_index])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="applying-pca-to-training-test-sets" class="level3" data-number="5.7.3">
<h3 data-number="5.7.3" class="anchored" data-anchor-id="applying-pca-to-training-test-sets"><span class="header-section-number">5.7.3</span> Applying PCA to Training &amp; Test sets</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Principal Component Analysis (PCA) preprocessing on the training data</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">preProcess</span>(training_set[, <span class="sc">-</span>target_index], </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">'pca'</span>, <span class="at">pcaComp =</span> <span class="dv">8</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply PCA transformation to original training set</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>training_set <span class="ot">&lt;-</span> <span class="fu">predict</span>(pca, training_set)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns, moving the dependent feature index to the end</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>training_set <span class="ot">&lt;-</span> training_set[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">1</span>)]</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply PCA transformation to original test set</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>test_set <span class="ot">&lt;-</span> <span class="fu">predict</span>(pca, test_set)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns, moving the dependent feature index to the end</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>test_set <span class="ot">&lt;-</span> test_set[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">1</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="press-predicted-r2-functions" class="level3" data-number="5.7.4">
<h3 data-number="5.7.4" class="anchored" data-anchor-id="press-predicted-r2-functions"><span class="header-section-number">5.7.4</span> PRESS &amp; Predicted <span class="math inline">\(R^2\)</span> Functions</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PRESS - predicted residual sums of squares</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>PRESS <span class="ot">&lt;-</span> <span class="cf">function</span>(linear.model) {</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the predictive residuals</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> <span class="fu">residuals</span>(linear.model)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">lm.influence</span>(linear.model)<span class="sc">$</span>hat)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the PRESS</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  PRESS <span class="ot">&lt;-</span> <span class="fu">sum</span>(pr<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(PRESS)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>pred_r_squared <span class="ot">&lt;-</span> <span class="cf">function</span>(linear.model) {</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use anova() to get the sum of squares for the linear model</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  lm.anova <span class="ot">&lt;-</span> <span class="fu">anova</span>(linear.model)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the total sum of squares</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  tss <span class="ot">&lt;-</span> <span class="fu">sum</span>(lm.anova<span class="sc">$</span><span class="st">'Sum Sq'</span>)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the predictive R^2</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  pred.r.squared <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">PRESS</span>(linear.model)<span class="sc">/</span>(tss)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pred.r.squared)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="pca-full-model-8-principal-components" class="level3" data-number="5.7.5">
<h3 data-number="5.7.5" class="anchored" data-anchor-id="pca-full-model-8-principal-components"><span class="header-section-number">5.7.5</span> PCA Full Model: 8 Principal Components</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reproducible random sampling</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(my_seed)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a multiple linear regression model</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>pca_full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(expected_survival <span class="sc">~</span> ., <span class="at">data =</span> training_set)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print a summary of the regression model</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(pca_full_model)</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(pca_full_model, <span class="at">string.p=</span><span class="st">"P-value"</span>, <span class="at">show.se=</span><span class="st">"T"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="4" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">expected_survival</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">std. Error</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">P-value</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">97.05</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">2.84</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">91.25&nbsp;–&nbsp;102.85</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">PC1</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">29.40</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.71</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">27.95&nbsp;–&nbsp;30.86</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">PC2</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">4.59</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.33</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.87&nbsp;–&nbsp;7.31</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.002</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">PC3</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.11</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.64</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-4.46&nbsp;–&nbsp;2.24</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.504</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">PC4</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">4.99</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.75</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.42&nbsp;–&nbsp;8.56</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.008</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">PC5</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-3.27</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">2.25</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-7.86&nbsp;–&nbsp;1.31</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.156</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">PC6</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">6.98</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">2.44</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">2.01&nbsp;–&nbsp;11.95</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.008</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">PC7</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-6.60</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">2.56</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-11.83&nbsp;–&nbsp;-1.37</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.015</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">PC8</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">3.80</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">2.82</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.96&nbsp;–&nbsp;9.56</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.188</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="4" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">39</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="4" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.983 / 0.979</td>
</tr>
</tbody>
</table>


</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate PRESS</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"PRESS: "</span>, <span class="fu">PRESS</span>(pca_full_model), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>PRESS:  31662.39 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate predicted R^2</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Predicted R^2: "</span>, <span class="fu">pred_r_squared</span>(pca_full_model), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Predicted R^2:  0.9430373 </code></pre>
</div>
</div>
</section>
<section id="visualization-of-uncorrelated-pca-matrix" class="level3" data-number="5.7.6">
<h3 data-number="5.7.6" class="anchored" data-anchor-id="visualization-of-uncorrelated-pca-matrix"><span class="header-section-number">5.7.6</span> Visualization of Uncorrelated PCA Matrix</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visual of Principal Components un-correlation</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(training_set)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(corr_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="analysis_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="pca-2-principal-components" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="pca-2-principal-components"><span class="header-section-number">5.8</span> PCA: 2 Principal Components</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a subset with 2 principal components</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>significant_pcs <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">9</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>train_pca <span class="ot">&lt;-</span> training_set[, significant_pcs]</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>test_pca <span class="ot">&lt;-</span> test_set[, significant_pcs]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reproducible random sampling</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(my_seed)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a multiple linear regression model</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>reg_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(expected_survival <span class="sc">~</span> ., </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> train_pca)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print a summary of the regression model</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(reg_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">expected_survival</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">97.05</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">89.78&nbsp;–&nbsp;104.32</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">PC1</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">29.40</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">27.58&nbsp;–&nbsp;31.23</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">PC2</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">4.59</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.18&nbsp;–&nbsp;8.00</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.010</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">39</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.968 / 0.966</td>
</tr>
</tbody>
</table>


</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate PRESS</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"PRESS: "</span>, <span class="fu">PRESS</span>(reg_model), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>PRESS:  25699.6 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate predicted R^2</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Predicted R^2: "</span>, <span class="fu">pred_r_squared</span>(reg_model), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Predicted R^2:  0.9537647 </code></pre>
</div>
</div>
<section id="principal-components-regression" class="level3" data-number="5.8.1">
<h3 data-number="5.8.1" class="anchored" data-anchor-id="principal-components-regression"><span class="header-section-number">5.8.1</span> <strong>Principal Components Regression</strong></h3>
<ul>
<li>PCA is used to calculate principal components that can then be used in&nbsp;principal components regression. This type of regression is often used when&nbsp;multicollinearity&nbsp;exists between predictors in a data set.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reproducible random sampling</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(my_seed)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> train_pca<span class="sc">$</span>expected_survival</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fit PCR</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>pcr_model <span class="ot">&lt;-</span> <span class="fu">pcr</span>(y <span class="sc">~</span> PC1<span class="sc">+</span>PC2, <span class="at">data=</span>train_pca, <span class="at">validation=</span><span class="st">"CV"</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>(pcr_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Principal component regression, fitted with the singular value decomposition algorithm.
Cross-validated using 10 random segments.
Call:
pcr(formula = y ~ PC1 + PC2, data = train_pca, validation = "CV")</code></pre>
</div>
</div>
</section>
<section id="repeated-cross-validation" class="level3" data-number="5.8.2">
<h3 data-number="5.8.2" class="anchored" data-anchor-id="repeated-cross-validation"><span class="header-section-number">5.8.2</span> Repeated Cross-Validation</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reproducible random sampling</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(my_seed)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeated cross-validation with 5 folds, 3 repetitions</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">3</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># training the model </span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>model_cv_repeat <span class="ot">&lt;-</span> <span class="fu">train</span>(expected_survival <span class="sc">~</span> ., </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> train_pca,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">trControl =</span> train_control)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print Overall Model Performance</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model_cv_repeat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression 

39 samples
 2 predictor

No pre-processing
Resampling: Cross-Validated (10 fold, repeated 3 times) 
Summary of sample sizes: 35, 35, 35, 35, 35, 35, ... 
Resampling results:

  RMSE      Rsquared   MAE     
  21.19074  0.9728849  16.05276

Tuning parameter 'intercept' was held constant at a value of TRUE</code></pre>
</div>
</div>
</section>
<section id="cross-validation" class="level3" data-number="5.8.3">
<h3 data-number="5.8.3" class="anchored" data-anchor-id="cross-validation"><span class="header-section-number">5.8.3</span> Cross-Validation</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reproducible random sampling</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(my_seed)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-validation with n folds</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>k_10 <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># training the model </span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>model_cv <span class="ot">&lt;-</span> <span class="fu">train</span>(expected_survival <span class="sc">~</span> ., </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> train_pca,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> k_10)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Print Model Performance</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>(model_cv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression 

39 samples
 2 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 35, 35, 35, 35, 35, 35, ... 
Resampling results:

  RMSE     Rsquared   MAE     
  21.7825  0.9761582  16.14872

Tuning parameter 'intercept' was held constant at a value of TRUE</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>cv_results <span class="ot">=</span> model_cv<span class="sc">$</span>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="predictions" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="predictions"><span class="header-section-number">5.9</span> Predictions</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the index position of the target feature</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>pred_target_index <span class="ot">&lt;-</span> <span class="fu">grep</span>(target_name, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">colnames</span>(test_pca))</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co">#cat("Target Feature Index =", pred_target_index)</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Predicted Target Feature (y-test) </span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> test_pca[pred_target_index]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions using the Cross-Validation model</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>y_pred <span class="ot">=</span> <span class="fu">predict</span>(model_cv, <span class="at">newdata =</span> test_pca[, <span class="sc">-</span>pred_target_index])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction Results from y_predictions</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">round</span>(y_pred, <span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform y_test from data frame to numeric</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>y_test_numeric <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(y_test))</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Original data</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co">#y_test_numeric</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>prediction_comparison <span class="ot">&lt;-</span> <span class="fu">cbind</span>(y_pred, y_test_numeric)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># table format</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(prediction_comparison) <span class="sc">%&gt;%</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-paper lightable-hover table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">y_pred</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">y_test_numeric</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">520</td>
<td style="text-align: right;">442</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: right;">310</td>
<td style="text-align: right;">318</td>
</tr>
<tr class="even">
<td style="text-align: left;">16</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">17</td>
<td style="text-align: right;">298</td>
<td style="text-align: right;">284</td>
</tr>
<tr class="even">
<td style="text-align: left;">18</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">152</td>
</tr>
<tr class="odd">
<td style="text-align: left;">21</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">160</td>
</tr>
<tr class="even">
<td style="text-align: left;">23</td>
<td style="text-align: right;">149</td>
<td style="text-align: right;">141</td>
</tr>
<tr class="odd">
<td style="text-align: left;">25</td>
<td style="text-align: right;">191</td>
<td style="text-align: right;">197</td>
</tr>
<tr class="even">
<td style="text-align: left;">26</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">95</td>
</tr>
<tr class="odd">
<td style="text-align: left;">28</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">40</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">78</td>
</tr>
<tr class="odd">
<td style="text-align: left;">43</td>
<td style="text-align: right;">113</td>
<td style="text-align: right;">38</td>
</tr>
<tr class="even">
<td style="text-align: left;">47</td>
<td style="text-align: right;">182</td>
<td style="text-align: right;">171</td>
</tr>
<tr class="odd">
<td style="text-align: left;">48</td>
<td style="text-align: right;">585</td>
<td style="text-align: right;">657</td>
</tr>
<tr class="even">
<td style="text-align: left;">52</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">53</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">92</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="prediction-metrics" class="level3" data-number="5.9.1">
<h3 data-number="5.9.1" class="anchored" data-anchor-id="prediction-metrics"><span class="header-section-number">5.9.1</span> Prediction Metrics</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Mean Absolute Error (MAE)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>mae_value <span class="ot">&lt;-</span> <span class="fu">mae</span>(y_pred, y_test_numeric)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co">#cat("MAE =", mae_value)</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate MSE</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>mse_predict <span class="ot">&lt;-</span> <span class="fu">mean</span>((y_pred <span class="sc">-</span> y_test_numeric)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co">#cat("\nMSE =", mse_predict)</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate RMSE</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>rmse_predict <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((y_pred <span class="sc">-</span> y_test_numeric)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co">#cat("\nRMSE =", rmse_predict)</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate R-squared (R^2)</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>predicted_r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>((y_test_numeric <span class="sc">-</span> y_pred)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> </span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((y_test_numeric <span class="sc">-</span> <span class="fu">mean</span>(y_test_numeric))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="co"># cat("\nPredicted R^2 =", predicted_r2)</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>prediction_metrics_df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mae_value, mse_predict,</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>                               rmse_predict, predicted_r2)</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="co"># table format</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(prediction_metrics_df) <span class="sc">%&gt;%</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-paper lightable-hover table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">mae_value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mse_predict</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rmse_predict</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">predicted_r2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">21.88235</td>
<td style="text-align: right;">1142.235</td>
<td style="text-align: right;">33.79697</td>
<td style="text-align: right;">0.9599766</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="training-conclusion" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="training-conclusion"><span class="header-section-number">5.10</span> Training Conclusion</h2>
<p>In conclusion, this project has demonstrated the effectiveness of Principal Component Analysis (PCA) in dimension reduction with the following key points:</p>
<ul>
<li><p>PCA was able to reduce from 37 features down to just 2 principal components.</p></li>
<li><p>The best score of R^2 = 97.61% was from the Linear Regression with Cross-validation model.</p></li>
<li><p>The predicted R^2 = 96%</p></li>
<li><p>The average deviation between the predicted values, and observed values for ‘Expected Survival’ is RMSE = 33.77.</p></li>
<li><p>The model has not been exposed to unseen data with a large amount of observations to asses its robustness, and reliability.</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./methods.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Methods</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./abalone.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Abalone</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>