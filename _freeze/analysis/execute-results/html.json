{
  "hash": "6a33d94e81cfb47085e7d51aa024a9fc",
  "result": {
    "markdown": "# Analysis\n\n\n::: {.cell}\n\n:::\n\n\n## Libraries\n\nThe packages used in this analysis are tidyverse @tidyverse, olsrr @olsrr, caret @caret, kableExtra @kableExtra, sjPlot @sjPlot, factoextra @factoextra, caTools @caTools, ggcorrplot @ggcorrplot, pls @pls, and Metrics @Metrics.\n\n## Data Preparation\n\nThis analysis uses the Dialysis dataset introduced previously. Within this context, we restructured the variables, enhancing their meaningfulness and facilitating inferential analysis. Additionally, the mean imputation approach addressed missing values.\n\n## Assumptions\n\nPCA relies on certain assumptions, the fulfillment of which is essential for the validity of this technique.\n\n-   **Linearity**: PCA assumes that the dataset is a linear combination of the variables. The variables exhibit relationships among themselves [@chumney2012pcaefa].\n\n-   **Importance of mean and covariance**: PCA assumes that the directions of maximum variance will contain good features for discrimination.\n\n-   **Correlation between features**: PCA assumes a correlation between features.\n\n-   **Normalization of data**: Normalization of data is necessary to apply PCA. Unscaled data can cause relative comparison problems of the dataset [@chumney2012pcaefa]. In addition, the data should contain no significant outliers.\n\n-   **Orthogonality**: The principal components are orthogonal to each other.\n\n-   **Sampling adequacy**: PCA assumes that there is sampling adequacy.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n## Feature Scaling\n\n### Standardization\n\nIt is important to Mean-Center the data prior to PCA model building to ensure the first Principal Component is in the direction of maximum variance.\n\n-   Standardization produces Mean, $\\mu$= 0, and Standard Deviation, $\\sigma$ = 1.\n\n-   We can rewrite this as:\n\n    $$\n    Z = \\frac{{x - \\mu}}{{\\sigma}}\n    $$\n\n    $$\n    Z \\sim N(0,1)\n    $$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Find the index position of the target feature \ntarget_name <- \"expected_survival\"\ntarget_index <- grep(target_name, \n                     colnames(train_data))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Standardization Numerical Features\ntrain_data_sc <- scale(train_data[, -target_index])\n```\n:::\n\n\n## PCA Requirements\n\n### Outliers Detection\n\n-   There are some outliers in the data frame including the dependent variable.\n-   However, there are three outliers with no high leverage.\n-   Outliers are important because these can have a disproportionate influence on results.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot a boxplot to visualize potential outliers\nboxplot(train_data, main = \"Outliers Detection\",\n        col = \"steelblue\")\n```\n\n::: {.cell-output-display}\n![](analysis_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Dependent Variable outliers\ntrain_data %>% \n  ggplot(aes(y=expected_survival)) +\n  geom_boxplot(fill=\"steelblue\", alpha=0.75) + \n  xlab(\"Expected Survival\")+\n  ylab(\"\")+\n  ggtitle(\"Dependent Variable Outliers\")\n```\n\n::: {.cell-output-display}\n![](analysis_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n### Leverage\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(my_seed)\n\n# Fit regression model\nordinary_model <- lm(expected_survival ~ ., data = train_data)\n\n# Print the model summary\nsummary(ordinary_model)\n\n# Residual Diagnostics\nols_plot_resid_lev(ordinary_model)\n```\n\n::: {.cell-output-display}\n![](analysis_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n### Removing Outliers\n\nAfter removing one outlier from the dataset, we discovered that the final results produced minimal variability. Therefore, we decided to present a model that captures all the data points' information; thus, no observations will be removed from the final model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# No Outliers subset\nno_outliers_df <- slice(train_data, -c(56))\n\nset.seed(my_seed)\n\n# Fit regression model\nno_outliers_model <- lm(expected_survival ~ ., data = no_outliers_df)\n\n# Print the model summary\nsummary(no_outliers_model)\n\n# Residual Diagnostics\nols_plot_resid_lev(no_outliers_model)\n```\n\n::: {.cell-output-display}\n![](analysis_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n### Correlations\n\n-   Multicollinearity is present in the data set.\n\n-   28 Correlated features were identified using a threshold = 0.30.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate correlations and round to 2 digits\ncorr_matrix <- cor(train_data_sc)\ncorr_matrix <- round(corr_matrix, digits = 2)\n\n# Print names of highly correlated features; threshold > 0.30\nhigh <- findCorrelation(corr_matrix, cutoff = 0.30, names = TRUE)\n\n# Create a data frame with an index column\nhigh_corr_df <- data.frame(\n  Count = 1:length(high),\n  Feature = high\n)\n\n# table format\nkbl(high_corr_df, caption = \"Highly Correlated Features\") %>%\n  kable_paper(\"hover\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper lightable-hover\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n<caption>Highly Correlated Features</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Count </th>\n   <th style=\"text-align:left;\"> Feature </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> expected_transfusion </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:left;\"> better_infection </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> expected_hospitalization </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> expected_hospital_readmission </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:left;\"> expected_fistula </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:left;\"> prevalent_transplant_waitlist_expected </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:left;\"> incident_transplant_waitlist_expected </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> expected_infection </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:left;\"> worse_survival </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:left;\"> incident_transplant_waitlist_better </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:left;\"> better_hospital_readmission </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> worse_transfusion </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:left;\"> worse_hospital_readmission </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:left;\"> worse_fistula </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:left;\"> incident_transplant_waitlist_worse </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> better_fistula </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:left;\"> prevalent_transplant_waitlist_better </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:left;\"> better_survival </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:left;\"> worse_infection </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> phosphorus (5.6 - 7) Mg </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:left;\"> prevalent_transplant_waitlist_worse </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 22 </td>\n   <td style=\"text-align:left;\"> phosphorus (3.5 - 4.5) Mg </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:left;\"> phosphorus &gt; 7Mg </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 24 </td>\n   <td style=\"text-align:left;\"> better_transfusion </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:left;\"> Hgb 10g </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 26 </td>\n   <td style=\"text-align:left;\"> hypercalcemia_calcium &gt; 10.2Mg </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:left;\"> pediatric_nPCR </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:left;\"> long_term_catheter </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncorrplot::corrplot(corr_matrix, type = \"full\", tl.pos = \"n\")\n```\n\n::: {.cell-output-display}\n![](analysis_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n## Full Model Regression\n\n-   The Adjusted $R^2$ = 99.99% is an indication of over-fitting, or high variance.\n-   This dataset is suitable to apply PCA to find the adequate variance balance.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(my_seed)\n\n# Fit a multiple linear regression model\nfull_model <- lm(expected_survival ~ ., data = train_data)\n\n# Print a summary of the regression model\ntab_model(full_model, title = \"Full Model Regression\", \n          string.p=\"P-value\", string.stat = \"T-score\",\n          string.se = \"Std. Error\",\n          string.resp = \"Response\",\n          string.ci = \"Conf Int.\",\n          show.se=T, show.stat = T,\n           CSS = list(\n             css.depvarhead = 'font-weight: bold; text-align: left;',\n             css.summary = 'color: #10759B; font-weight: bold;'\n           ))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<caption style=\"font-weight: bold; text-align:left;\">Full Model Regression</caption>\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:italic; font-weight:normal; padding:0.2cm; border-bottom:1px solid black; text-align:left; \">&nbsp;</th>\n<th colspan=\"5\" style=\"border-top: double; text-align:center; font-style:italic; font-weight:normal; padding:0.2cm; border-bottom:1px solid black;\">expected_survival</th>\n</tr>\n<tr>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; text-align:left; \">Predictors</td>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; \">Estimates</td>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; \">Std. Error</td>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; \">Conf Int.</td>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; \">T-score</td>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; \">P-value</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">93.71</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">41.88</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.73&nbsp;&ndash;&nbsp;181.69</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.24</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.038</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">better transfusion</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.75</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.53&nbsp;&ndash;&nbsp;2.62</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.39</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.181</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">expected transfusion</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.07&nbsp;&ndash;&nbsp;0.07</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.974</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">worse transfusion</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.13</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.08</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.03&nbsp;&ndash;&nbsp;0.29</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.76</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.096</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">better infection</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.27</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.46&nbsp;&ndash;&nbsp;-0.07</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.92</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.009</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">expected infection</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.06</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.17&nbsp;&ndash;&nbsp;0.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.57</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.574</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">worse infection</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.11</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.27</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.68&nbsp;&ndash;&nbsp;0.46</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.41</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.687</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Kt v 1 2</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.25</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.25</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.28&nbsp;&ndash;&nbsp;0.78</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.99</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.335</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Kt v 1 7</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.05</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.11&nbsp;&ndash;&nbsp;0.11</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.996</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pedriatic Kt v 1 2</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.11&nbsp;&ndash;&nbsp;0.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.21</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.241</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pediatric Kt v 1 8</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.02</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.01</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.04&nbsp;&ndash;&nbsp;0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.89</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.076</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">pediatric nPCR</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.01&nbsp;&ndash;&nbsp;0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.75</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.097</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">better fistula</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.18</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.11</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.41&nbsp;&ndash;&nbsp;0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.73</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.101</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">expected fistula</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.01</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.08</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.15&nbsp;&ndash;&nbsp;0.16</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.08</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.935</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">worse fistula</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.11</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.25&nbsp;&ndash;&nbsp;0.19</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.28</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.780</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">long term catheter</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.31</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.07</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.16&nbsp;&ndash;&nbsp;0.47</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">4.19</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">hypercalcemia calcium ><br>10 2Mg</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.19</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.37&nbsp;&ndash;&nbsp;-0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.13</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.048</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">phosphorus < 3 5Mg</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.35</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.48</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.66&nbsp;&ndash;&nbsp;1.36</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.73</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.476</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">phosphorus (3 5 - 4 5) Mg</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.73</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.46</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.71&nbsp;&ndash;&nbsp;-0.76</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;3.73</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.002</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">phosphorus (4 6 - 5 5) Mg</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.36</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.46</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.33&nbsp;&ndash;&nbsp;-0.40</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.97</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.008</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">phosphorus (5 6 - 7) Mg</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.80</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.44</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.72&nbsp;&ndash;&nbsp;0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.82</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.085</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">phosphorus > 7Mg</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.44</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.46</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.41&nbsp;&ndash;&nbsp;-0.48</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;3.15</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.005</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">better hospitalization</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.08</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.32</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.59&nbsp;&ndash;&nbsp;0.76</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.26</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.797</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">expected hospitalization</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.70</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.15</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.38&nbsp;&ndash;&nbsp;1.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">4.55</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">worse hospitalization</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.52</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.22</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.05&nbsp;&ndash;&nbsp;0.98</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.34</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.031</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">better hospital<br>readmission</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.38</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.24</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.13&nbsp;&ndash;&nbsp;0.88</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.55</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.139</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">expected hospital<br>readmission</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.31</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.13</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.03&nbsp;&ndash;&nbsp;0.60</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.34</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.031</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">worse hospital<br>readmission</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.24</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.41&nbsp;&ndash;&nbsp;0.59</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.39</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.704</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">better survival</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.57</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.15</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.88&nbsp;&ndash;&nbsp;-0.27</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;3.94</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">worse survival</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.91</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.14</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.20&nbsp;&ndash;&nbsp;-0.62</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;6.64</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">incident transplant<br>waitlist better</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.01</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.13</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.27&nbsp;&ndash;&nbsp;0.29</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.926</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">incident transplant<br>waitlist expected</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.05&nbsp;&ndash;&nbsp;0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.82</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.421</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">incident transplant<br>waitlist worse</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.31</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.06&nbsp;&ndash;&nbsp;0.56</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.61</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.018</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">prevalent transplant<br>waitlist better</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.15</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.11</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.08&nbsp;&ndash;&nbsp;0.38</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.36</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.191</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">prevalent transplant<br>waitlist expected</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.17&nbsp;&ndash;&nbsp;0.25</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.41</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.690</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">prevalent transplant<br>waitlist worse</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.01</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.19</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.39&nbsp;&ndash;&nbsp;0.40</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.975</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Hgb 10g</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.05</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.20&nbsp;&ndash;&nbsp;-0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.14</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.046</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Hgb 12g</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.36</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.66</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.75&nbsp;&ndash;&nbsp;1.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.54</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.597</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; color: #10759B; font-weight: bold; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; color: #10759B; font-weight: bold; text-align:center; border-top:1px solid;\" colspan=\"5\">56</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; color: #10759B; font-weight: bold;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; color: #10759B; font-weight: bold; text-align:center;\" colspan=\"5\">1.000 / 1.000</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n## PCA Implementation\n\n### SVD - Singular Value Decomposition\n\nWe will focus on Singular Value Decomposition which is a classic approach for PCA analysis.\n\nSingular Value Decomposition is a factorization technique used in linear algebra to decompose a matrix into three matrices.\n\n1.  $L$: A matrix whose columns are the left singular vectors of the original matrix.\n\n2.  $D$: A diagonal matrix whose entries are the singular values of the original matrix.\n\n3.  $R$: A matrix whose columns are the right singular vectors of the original matrix.\n\nThe SVD is closely related to the eigenvalue decomposition (EVD), which is another factorization technique used in linear algebra. While the EVD can only be applied to square matrices, the SVD can be applied to any matrix, including rectangular matrices. The SVD is also more numerically stable than the EVD, making it a preferred method for many applications.\n\n-   Note: The Spectral Decomposition approach is used with the princomp() function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Apply PCA using prcomp()\ndata_pca <- prcomp(train_data_sc, center = TRUE, scale. = TRUE)\npca_summ <- summary(data_pca)$importance\n\n# Transpose the matrix\ntransposed_pca_summ <- t(pca_summ)\n\n# table format\nkbl(transposed_pca_summ, caption = \"Pricipal Components Analysis\",\n    digits = 4) %>%\n  kable_paper(\"hover\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper lightable-hover\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n<caption>Pricipal Components Analysis</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Standard deviation </th>\n   <th style=\"text-align:right;\"> Proportion of Variance </th>\n   <th style=\"text-align:right;\"> Cumulative Proportion </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> PC1 </td>\n   <td style=\"text-align:right;\"> 3.8854 </td>\n   <td style=\"text-align:right;\"> 0.4080 </td>\n   <td style=\"text-align:right;\"> 0.4080 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC2 </td>\n   <td style=\"text-align:right;\"> 1.8717 </td>\n   <td style=\"text-align:right;\"> 0.0947 </td>\n   <td style=\"text-align:right;\"> 0.5027 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC3 </td>\n   <td style=\"text-align:right;\"> 1.8377 </td>\n   <td style=\"text-align:right;\"> 0.0913 </td>\n   <td style=\"text-align:right;\"> 0.5940 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC4 </td>\n   <td style=\"text-align:right;\"> 1.7487 </td>\n   <td style=\"text-align:right;\"> 0.0826 </td>\n   <td style=\"text-align:right;\"> 0.6766 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC5 </td>\n   <td style=\"text-align:right;\"> 1.4227 </td>\n   <td style=\"text-align:right;\"> 0.0547 </td>\n   <td style=\"text-align:right;\"> 0.7313 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC6 </td>\n   <td style=\"text-align:right;\"> 1.2508 </td>\n   <td style=\"text-align:right;\"> 0.0423 </td>\n   <td style=\"text-align:right;\"> 0.7736 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC7 </td>\n   <td style=\"text-align:right;\"> 1.1280 </td>\n   <td style=\"text-align:right;\"> 0.0344 </td>\n   <td style=\"text-align:right;\"> 0.8080 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC8 </td>\n   <td style=\"text-align:right;\"> 1.0933 </td>\n   <td style=\"text-align:right;\"> 0.0323 </td>\n   <td style=\"text-align:right;\"> 0.8403 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC9 </td>\n   <td style=\"text-align:right;\"> 0.9449 </td>\n   <td style=\"text-align:right;\"> 0.0241 </td>\n   <td style=\"text-align:right;\"> 0.8644 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC10 </td>\n   <td style=\"text-align:right;\"> 0.9081 </td>\n   <td style=\"text-align:right;\"> 0.0223 </td>\n   <td style=\"text-align:right;\"> 0.8867 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC11 </td>\n   <td style=\"text-align:right;\"> 0.8185 </td>\n   <td style=\"text-align:right;\"> 0.0181 </td>\n   <td style=\"text-align:right;\"> 0.9048 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC12 </td>\n   <td style=\"text-align:right;\"> 0.7790 </td>\n   <td style=\"text-align:right;\"> 0.0164 </td>\n   <td style=\"text-align:right;\"> 0.9212 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC13 </td>\n   <td style=\"text-align:right;\"> 0.6815 </td>\n   <td style=\"text-align:right;\"> 0.0126 </td>\n   <td style=\"text-align:right;\"> 0.9338 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC14 </td>\n   <td style=\"text-align:right;\"> 0.6366 </td>\n   <td style=\"text-align:right;\"> 0.0110 </td>\n   <td style=\"text-align:right;\"> 0.9447 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC15 </td>\n   <td style=\"text-align:right;\"> 0.5710 </td>\n   <td style=\"text-align:right;\"> 0.0088 </td>\n   <td style=\"text-align:right;\"> 0.9535 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC16 </td>\n   <td style=\"text-align:right;\"> 0.5055 </td>\n   <td style=\"text-align:right;\"> 0.0069 </td>\n   <td style=\"text-align:right;\"> 0.9604 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC17 </td>\n   <td style=\"text-align:right;\"> 0.5018 </td>\n   <td style=\"text-align:right;\"> 0.0068 </td>\n   <td style=\"text-align:right;\"> 0.9673 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC18 </td>\n   <td style=\"text-align:right;\"> 0.4884 </td>\n   <td style=\"text-align:right;\"> 0.0064 </td>\n   <td style=\"text-align:right;\"> 0.9737 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC19 </td>\n   <td style=\"text-align:right;\"> 0.4625 </td>\n   <td style=\"text-align:right;\"> 0.0058 </td>\n   <td style=\"text-align:right;\"> 0.9795 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC20 </td>\n   <td style=\"text-align:right;\"> 0.4169 </td>\n   <td style=\"text-align:right;\"> 0.0047 </td>\n   <td style=\"text-align:right;\"> 0.9842 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC21 </td>\n   <td style=\"text-align:right;\"> 0.3534 </td>\n   <td style=\"text-align:right;\"> 0.0034 </td>\n   <td style=\"text-align:right;\"> 0.9876 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC22 </td>\n   <td style=\"text-align:right;\"> 0.3247 </td>\n   <td style=\"text-align:right;\"> 0.0029 </td>\n   <td style=\"text-align:right;\"> 0.9904 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC23 </td>\n   <td style=\"text-align:right;\"> 0.2884 </td>\n   <td style=\"text-align:right;\"> 0.0022 </td>\n   <td style=\"text-align:right;\"> 0.9926 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC24 </td>\n   <td style=\"text-align:right;\"> 0.2604 </td>\n   <td style=\"text-align:right;\"> 0.0018 </td>\n   <td style=\"text-align:right;\"> 0.9945 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC25 </td>\n   <td style=\"text-align:right;\"> 0.2259 </td>\n   <td style=\"text-align:right;\"> 0.0014 </td>\n   <td style=\"text-align:right;\"> 0.9959 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC26 </td>\n   <td style=\"text-align:right;\"> 0.2149 </td>\n   <td style=\"text-align:right;\"> 0.0013 </td>\n   <td style=\"text-align:right;\"> 0.9971 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC27 </td>\n   <td style=\"text-align:right;\"> 0.1982 </td>\n   <td style=\"text-align:right;\"> 0.0011 </td>\n   <td style=\"text-align:right;\"> 0.9982 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC28 </td>\n   <td style=\"text-align:right;\"> 0.1670 </td>\n   <td style=\"text-align:right;\"> 0.0008 </td>\n   <td style=\"text-align:right;\"> 0.9989 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC29 </td>\n   <td style=\"text-align:right;\"> 0.1268 </td>\n   <td style=\"text-align:right;\"> 0.0004 </td>\n   <td style=\"text-align:right;\"> 0.9994 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC30 </td>\n   <td style=\"text-align:right;\"> 0.1091 </td>\n   <td style=\"text-align:right;\"> 0.0003 </td>\n   <td style=\"text-align:right;\"> 0.9997 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC31 </td>\n   <td style=\"text-align:right;\"> 0.0838 </td>\n   <td style=\"text-align:right;\"> 0.0002 </td>\n   <td style=\"text-align:right;\"> 0.9999 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC32 </td>\n   <td style=\"text-align:right;\"> 0.0509 </td>\n   <td style=\"text-align:right;\"> 0.0001 </td>\n   <td style=\"text-align:right;\"> 0.9999 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC33 </td>\n   <td style=\"text-align:right;\"> 0.0317 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n   <td style=\"text-align:right;\"> 1.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC34 </td>\n   <td style=\"text-align:right;\"> 0.0287 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n   <td style=\"text-align:right;\"> 1.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC35 </td>\n   <td style=\"text-align:right;\"> 0.0143 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n   <td style=\"text-align:right;\"> 1.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC36 </td>\n   <td style=\"text-align:right;\"> 0.0081 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n   <td style=\"text-align:right;\"> 1.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PC37 </td>\n   <td style=\"text-align:right;\"> 0.0049 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n   <td style=\"text-align:right;\"> 1.0000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### PCA - Elements\n\n-   The values in \\`**`` data_pca$x` ``** are the coordinates of each observation in the new principal component space. These coordinates are the scores for each observation along each principal component.\n\n-   The eigenvectors of the covariance, or correlation matrix of the data represent the directions of maximum variance, or information in the dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Principal Component scores vector\npc_scores <- data_pca$x\n\n# Std Deviation of Components\ncomponent_sdev <- data_pca$sdev\n\n# Eigenvector, or Loadings\npc_loadings <- data_pca$rotation\n\n# Mean of variables\ncomponent_mean <- data_pca$center \n\n# Scaling factor of Variables\ncomponent_scale <- data_pca$scale\n```\n:::\n\n\n### Loadings of First Two Components\n\n-   The loading \\`data_pca\\$rotation\\` are the weights assigned to each original variable for that particular principal component.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Access the loadings for the first two principal components\nloadings_first_two_components <- pc_loadings[, 1:2]\n\n# Print the loadings for the first two principal components\n# print(loadings_first_two_components)\n\n# table format\nkbl(loadings_first_two_components, \n    caption = \"Loadings of First Two Principal Components\",\n    digits = 4) %>%\n  kable_paper(\"hover\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper lightable-hover\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n<caption>Loadings of First Two Principal Components</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> PC1 </th>\n   <th style=\"text-align:right;\"> PC2 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> better_transfusion </td>\n   <td style=\"text-align:right;\"> 0.0506 </td>\n   <td style=\"text-align:right;\"> 0.0151 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> expected_transfusion </td>\n   <td style=\"text-align:right;\"> 0.2536 </td>\n   <td style=\"text-align:right;\"> -0.0214 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> worse_transfusion </td>\n   <td style=\"text-align:right;\"> 0.2058 </td>\n   <td style=\"text-align:right;\"> -0.1647 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> better_infection </td>\n   <td style=\"text-align:right;\"> 0.2526 </td>\n   <td style=\"text-align:right;\"> -0.0073 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> expected_infection </td>\n   <td style=\"text-align:right;\"> 0.2455 </td>\n   <td style=\"text-align:right;\"> -0.0652 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> worse_infection </td>\n   <td style=\"text-align:right;\"> 0.1381 </td>\n   <td style=\"text-align:right;\"> 0.0637 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Kt_v_1.2 </td>\n   <td style=\"text-align:right;\"> 0.0031 </td>\n   <td style=\"text-align:right;\"> 0.0081 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Kt_v_1.7 </td>\n   <td style=\"text-align:right;\"> -0.0078 </td>\n   <td style=\"text-align:right;\"> 0.0444 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pedriatic_Kt_v_1.2 </td>\n   <td style=\"text-align:right;\"> -0.0636 </td>\n   <td style=\"text-align:right;\"> 0.0527 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pediatric_Kt_v_1.8 </td>\n   <td style=\"text-align:right;\"> -0.0139 </td>\n   <td style=\"text-align:right;\"> 0.0028 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pediatric_nPCR </td>\n   <td style=\"text-align:right;\"> -0.0394 </td>\n   <td style=\"text-align:right;\"> 0.0768 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> better_fistula </td>\n   <td style=\"text-align:right;\"> 0.1701 </td>\n   <td style=\"text-align:right;\"> 0.1849 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> expected_fistula </td>\n   <td style=\"text-align:right;\"> 0.2521 </td>\n   <td style=\"text-align:right;\"> -0.0558 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> worse_fistula </td>\n   <td style=\"text-align:right;\"> 0.1932 </td>\n   <td style=\"text-align:right;\"> -0.0481 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> long_term_catheter </td>\n   <td style=\"text-align:right;\"> -0.0054 </td>\n   <td style=\"text-align:right;\"> 0.0409 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hypercalcemia_calcium &gt; 10.2Mg </td>\n   <td style=\"text-align:right;\"> -0.0276 </td>\n   <td style=\"text-align:right;\"> 0.1049 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> phosphorus &lt; 3.5Mg </td>\n   <td style=\"text-align:right;\"> 0.0161 </td>\n   <td style=\"text-align:right;\"> 0.3759 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> phosphorus (3.5 - 4.5) Mg </td>\n   <td style=\"text-align:right;\"> 0.0420 </td>\n   <td style=\"text-align:right;\"> 0.4258 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> phosphorus (4.6 - 5.5) Mg </td>\n   <td style=\"text-align:right;\"> 0.0888 </td>\n   <td style=\"text-align:right;\"> 0.2665 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> phosphorus (5.6 - 7) Mg </td>\n   <td style=\"text-align:right;\"> -0.0954 </td>\n   <td style=\"text-align:right;\"> -0.3297 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> phosphorus &gt; 7Mg </td>\n   <td style=\"text-align:right;\"> -0.0293 </td>\n   <td style=\"text-align:right;\"> -0.4400 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> better_hospitalization </td>\n   <td style=\"text-align:right;\"> 0.1555 </td>\n   <td style=\"text-align:right;\"> 0.0398 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> expected_hospitalization </td>\n   <td style=\"text-align:right;\"> 0.2535 </td>\n   <td style=\"text-align:right;\"> -0.0353 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> worse_hospitalization </td>\n   <td style=\"text-align:right;\"> 0.1863 </td>\n   <td style=\"text-align:right;\"> -0.1048 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> better_hospital_readmission </td>\n   <td style=\"text-align:right;\"> 0.2100 </td>\n   <td style=\"text-align:right;\"> -0.0462 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> expected_hospital_readmission </td>\n   <td style=\"text-align:right;\"> 0.2537 </td>\n   <td style=\"text-align:right;\"> -0.0414 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> worse_hospital_readmission </td>\n   <td style=\"text-align:right;\"> 0.2010 </td>\n   <td style=\"text-align:right;\"> -0.0432 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> better_survival </td>\n   <td style=\"text-align:right;\"> 0.1523 </td>\n   <td style=\"text-align:right;\"> 0.1688 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> worse_survival </td>\n   <td style=\"text-align:right;\"> 0.2288 </td>\n   <td style=\"text-align:right;\"> -0.0662 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> incident_transplant_waitlist_better </td>\n   <td style=\"text-align:right;\"> 0.2016 </td>\n   <td style=\"text-align:right;\"> 0.1513 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> incident_transplant_waitlist_expected </td>\n   <td style=\"text-align:right;\"> 0.2499 </td>\n   <td style=\"text-align:right;\"> -0.0578 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> incident_transplant_waitlist_worse </td>\n   <td style=\"text-align:right;\"> 0.1913 </td>\n   <td style=\"text-align:right;\"> -0.0199 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> prevalent_transplant_waitlist_better </td>\n   <td style=\"text-align:right;\"> 0.1618 </td>\n   <td style=\"text-align:right;\"> 0.1763 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> prevalent_transplant_waitlist_expected </td>\n   <td style=\"text-align:right;\"> 0.2501 </td>\n   <td style=\"text-align:right;\"> -0.0703 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> prevalent_transplant_waitlist_worse </td>\n   <td style=\"text-align:right;\"> 0.1202 </td>\n   <td style=\"text-align:right;\"> -0.2285 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hgb 10g </td>\n   <td style=\"text-align:right;\"> -0.0299 </td>\n   <td style=\"text-align:right;\"> -0.0804 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hgb 12g </td>\n   <td style=\"text-align:right;\"> -0.0006 </td>\n   <td style=\"text-align:right;\"> 0.1765 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### PCA - Cumulative Variance\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Proportion of variance explained by each PC\nvariance_explained <- component_sdev^2 / sum(component_sdev^2)\n\n# Cumulative proportion of variance explained\ncumulative_variance_explained <- cumsum(variance_explained)\n\n# Create a data frame with an index column\ncumulative_variance_explained_df <- data.frame(\n  Pincipal_Component = 1:length(cumulative_variance_explained),\n  Cumulative_Variance_Explained = cumulative_variance_explained\n)\n\n# Create a kable table with an index column\nkbl(cumulative_variance_explained_df, align = \"cl\",\n    caption = \"PCA: Cumulative Variance Explained\",\n    digits = 4) %>%\n  kable_paper(\"hover\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper lightable-hover\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n<caption>PCA: Cumulative Variance Explained</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> Pincipal_Component </th>\n   <th style=\"text-align:left;\"> Cumulative_Variance_Explained </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:left;\"> 0.4080 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:left;\"> 0.5027 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 3 </td>\n   <td style=\"text-align:left;\"> 0.5940 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 4 </td>\n   <td style=\"text-align:left;\"> 0.6766 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 5 </td>\n   <td style=\"text-align:left;\"> 0.7313 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:left;\"> 0.7736 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 7 </td>\n   <td style=\"text-align:left;\"> 0.8080 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:left;\"> 0.8403 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 9 </td>\n   <td style=\"text-align:left;\"> 0.8644 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 10 </td>\n   <td style=\"text-align:left;\"> 0.8867 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 11 </td>\n   <td style=\"text-align:left;\"> 0.9048 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:left;\"> 0.9212 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 13 </td>\n   <td style=\"text-align:left;\"> 0.9338 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:left;\"> 0.9447 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 15 </td>\n   <td style=\"text-align:left;\"> 0.9535 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 16 </td>\n   <td style=\"text-align:left;\"> 0.9604 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 17 </td>\n   <td style=\"text-align:left;\"> 0.9673 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 18 </td>\n   <td style=\"text-align:left;\"> 0.9737 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 19 </td>\n   <td style=\"text-align:left;\"> 0.9795 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 20 </td>\n   <td style=\"text-align:left;\"> 0.9842 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 21 </td>\n   <td style=\"text-align:left;\"> 0.9876 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 22 </td>\n   <td style=\"text-align:left;\"> 0.9904 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 23 </td>\n   <td style=\"text-align:left;\"> 0.9927 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 24 </td>\n   <td style=\"text-align:left;\"> 0.9945 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 25 </td>\n   <td style=\"text-align:left;\"> 0.9959 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 26 </td>\n   <td style=\"text-align:left;\"> 0.9971 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 27 </td>\n   <td style=\"text-align:left;\"> 0.9982 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 28 </td>\n   <td style=\"text-align:left;\"> 0.9989 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 29 </td>\n   <td style=\"text-align:left;\"> 0.9994 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 30 </td>\n   <td style=\"text-align:left;\"> 0.9997 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 31 </td>\n   <td style=\"text-align:left;\"> 0.9999 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 32 </td>\n   <td style=\"text-align:left;\"> 0.9999 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 33 </td>\n   <td style=\"text-align:left;\"> 1.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 34 </td>\n   <td style=\"text-align:left;\"> 1.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 35 </td>\n   <td style=\"text-align:left;\"> 1.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 36 </td>\n   <td style=\"text-align:left;\"> 1.0000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 37 </td>\n   <td style=\"text-align:left;\"> 1.0000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### PCA - Number of Principal Components\n\n-   We can conclude that 9 Principal Components explain 86% of the variance.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Retain components that explain a percentage of the variance\nnum_components <- which(cumulative_variance_explained >= 0.86)[1]\n\n# Select the desired number of principal components\nselected_pcs <- pc_scores[, 1:num_components]\n\n# table format\nkbl(selected_pcs, caption = \"Components Explaining 86% Variance\",\n    digits = 4) %>%\n  kable_paper(\"hover\", full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper lightable-hover\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n<caption>Components Explaining 86% Variance</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> PC1 </th>\n   <th style=\"text-align:right;\"> PC2 </th>\n   <th style=\"text-align:right;\"> PC3 </th>\n   <th style=\"text-align:right;\"> PC4 </th>\n   <th style=\"text-align:right;\"> PC5 </th>\n   <th style=\"text-align:right;\"> PC6 </th>\n   <th style=\"text-align:right;\"> PC7 </th>\n   <th style=\"text-align:right;\"> PC8 </th>\n   <th style=\"text-align:right;\"> PC9 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> -3.1378 </td>\n   <td style=\"text-align:right;\"> 0.7718 </td>\n   <td style=\"text-align:right;\"> -0.7364 </td>\n   <td style=\"text-align:right;\"> -0.9222 </td>\n   <td style=\"text-align:right;\"> -0.3593 </td>\n   <td style=\"text-align:right;\"> 0.3854 </td>\n   <td style=\"text-align:right;\"> 1.7645 </td>\n   <td style=\"text-align:right;\"> 0.7137 </td>\n   <td style=\"text-align:right;\"> -1.2776 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.9109 </td>\n   <td style=\"text-align:right;\"> -1.3736 </td>\n   <td style=\"text-align:right;\"> -0.8907 </td>\n   <td style=\"text-align:right;\"> -0.0460 </td>\n   <td style=\"text-align:right;\"> 0.0228 </td>\n   <td style=\"text-align:right;\"> 0.3267 </td>\n   <td style=\"text-align:right;\"> 1.9095 </td>\n   <td style=\"text-align:right;\"> 0.3203 </td>\n   <td style=\"text-align:right;\"> 0.3158 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -1.3650 </td>\n   <td style=\"text-align:right;\"> -1.7656 </td>\n   <td style=\"text-align:right;\"> -0.1449 </td>\n   <td style=\"text-align:right;\"> 0.2592 </td>\n   <td style=\"text-align:right;\"> -1.2857 </td>\n   <td style=\"text-align:right;\"> -0.3762 </td>\n   <td style=\"text-align:right;\"> -0.7856 </td>\n   <td style=\"text-align:right;\"> -0.9204 </td>\n   <td style=\"text-align:right;\"> -1.2626 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -3.0594 </td>\n   <td style=\"text-align:right;\"> 0.3348 </td>\n   <td style=\"text-align:right;\"> -0.0141 </td>\n   <td style=\"text-align:right;\"> -0.1395 </td>\n   <td style=\"text-align:right;\"> 0.0920 </td>\n   <td style=\"text-align:right;\"> -0.2825 </td>\n   <td style=\"text-align:right;\"> -0.1286 </td>\n   <td style=\"text-align:right;\"> 0.1373 </td>\n   <td style=\"text-align:right;\"> 0.0780 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -0.1991 </td>\n   <td style=\"text-align:right;\"> -0.2073 </td>\n   <td style=\"text-align:right;\"> -0.7149 </td>\n   <td style=\"text-align:right;\"> -1.3756 </td>\n   <td style=\"text-align:right;\"> -1.1993 </td>\n   <td style=\"text-align:right;\"> 0.0319 </td>\n   <td style=\"text-align:right;\"> 0.7499 </td>\n   <td style=\"text-align:right;\"> 0.7160 </td>\n   <td style=\"text-align:right;\"> -0.1954 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.2032 </td>\n   <td style=\"text-align:right;\"> 2.6187 </td>\n   <td style=\"text-align:right;\"> -7.7363 </td>\n   <td style=\"text-align:right;\"> 4.0519 </td>\n   <td style=\"text-align:right;\"> -0.8244 </td>\n   <td style=\"text-align:right;\"> -2.8218 </td>\n   <td style=\"text-align:right;\"> -0.3937 </td>\n   <td style=\"text-align:right;\"> 0.7540 </td>\n   <td style=\"text-align:right;\"> 0.1236 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -1.1596 </td>\n   <td style=\"text-align:right;\"> 1.1216 </td>\n   <td style=\"text-align:right;\"> -0.7112 </td>\n   <td style=\"text-align:right;\"> -0.6842 </td>\n   <td style=\"text-align:right;\"> 0.2286 </td>\n   <td style=\"text-align:right;\"> -0.3821 </td>\n   <td style=\"text-align:right;\"> -0.5148 </td>\n   <td style=\"text-align:right;\"> -1.3731 </td>\n   <td style=\"text-align:right;\"> 0.5560 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -1.7567 </td>\n   <td style=\"text-align:right;\"> 2.4464 </td>\n   <td style=\"text-align:right;\"> 0.2336 </td>\n   <td style=\"text-align:right;\"> -0.7871 </td>\n   <td style=\"text-align:right;\"> -0.1098 </td>\n   <td style=\"text-align:right;\"> -1.0603 </td>\n   <td style=\"text-align:right;\"> -0.1434 </td>\n   <td style=\"text-align:right;\"> -1.6411 </td>\n   <td style=\"text-align:right;\"> 1.1462 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -2.5605 </td>\n   <td style=\"text-align:right;\"> 1.0785 </td>\n   <td style=\"text-align:right;\"> -0.0207 </td>\n   <td style=\"text-align:right;\"> -0.0018 </td>\n   <td style=\"text-align:right;\"> -0.2474 </td>\n   <td style=\"text-align:right;\"> 1.1930 </td>\n   <td style=\"text-align:right;\"> -0.1234 </td>\n   <td style=\"text-align:right;\"> 1.6484 </td>\n   <td style=\"text-align:right;\"> 1.1223 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -2.2725 </td>\n   <td style=\"text-align:right;\"> 0.7670 </td>\n   <td style=\"text-align:right;\"> -0.0552 </td>\n   <td style=\"text-align:right;\"> -1.0045 </td>\n   <td style=\"text-align:right;\"> 2.4430 </td>\n   <td style=\"text-align:right;\"> -1.8092 </td>\n   <td style=\"text-align:right;\"> 1.3011 </td>\n   <td style=\"text-align:right;\"> 0.0402 </td>\n   <td style=\"text-align:right;\"> 0.7853 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 10.2101 </td>\n   <td style=\"text-align:right;\"> -3.0951 </td>\n   <td style=\"text-align:right;\"> 5.5631 </td>\n   <td style=\"text-align:right;\"> -2.7079 </td>\n   <td style=\"text-align:right;\"> -3.2328 </td>\n   <td style=\"text-align:right;\"> -1.4788 </td>\n   <td style=\"text-align:right;\"> -1.0195 </td>\n   <td style=\"text-align:right;\"> 0.3946 </td>\n   <td style=\"text-align:right;\"> 0.0182 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5.1286 </td>\n   <td style=\"text-align:right;\"> -1.7705 </td>\n   <td style=\"text-align:right;\"> 1.7849 </td>\n   <td style=\"text-align:right;\"> -0.1628 </td>\n   <td style=\"text-align:right;\"> 0.5176 </td>\n   <td style=\"text-align:right;\"> -0.3672 </td>\n   <td style=\"text-align:right;\"> 1.2737 </td>\n   <td style=\"text-align:right;\"> 0.3839 </td>\n   <td style=\"text-align:right;\"> -0.1914 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -3.4958 </td>\n   <td style=\"text-align:right;\"> -4.4206 </td>\n   <td style=\"text-align:right;\"> -3.1425 </td>\n   <td style=\"text-align:right;\"> 0.0404 </td>\n   <td style=\"text-align:right;\"> -0.7928 </td>\n   <td style=\"text-align:right;\"> 0.4217 </td>\n   <td style=\"text-align:right;\"> 0.1087 </td>\n   <td style=\"text-align:right;\"> -1.1395 </td>\n   <td style=\"text-align:right;\"> -1.5791 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -1.7134 </td>\n   <td style=\"text-align:right;\"> 0.8230 </td>\n   <td style=\"text-align:right;\"> -1.9663 </td>\n   <td style=\"text-align:right;\"> -1.0871 </td>\n   <td style=\"text-align:right;\"> 0.7505 </td>\n   <td style=\"text-align:right;\"> 0.4357 </td>\n   <td style=\"text-align:right;\"> 1.1010 </td>\n   <td style=\"text-align:right;\"> 0.8853 </td>\n   <td style=\"text-align:right;\"> -1.1906 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -1.9511 </td>\n   <td style=\"text-align:right;\"> 0.9075 </td>\n   <td style=\"text-align:right;\"> -0.3459 </td>\n   <td style=\"text-align:right;\"> -1.4707 </td>\n   <td style=\"text-align:right;\"> -0.7735 </td>\n   <td style=\"text-align:right;\"> -0.7810 </td>\n   <td style=\"text-align:right;\"> -1.0116 </td>\n   <td style=\"text-align:right;\"> -1.4774 </td>\n   <td style=\"text-align:right;\"> 0.2215 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -2.6296 </td>\n   <td style=\"text-align:right;\"> 0.9149 </td>\n   <td style=\"text-align:right;\"> -0.5263 </td>\n   <td style=\"text-align:right;\"> -1.3484 </td>\n   <td style=\"text-align:right;\"> -0.9348 </td>\n   <td style=\"text-align:right;\"> 0.5181 </td>\n   <td style=\"text-align:right;\"> 0.3570 </td>\n   <td style=\"text-align:right;\"> 0.8863 </td>\n   <td style=\"text-align:right;\"> -0.4488 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4.7463 </td>\n   <td style=\"text-align:right;\"> 0.3146 </td>\n   <td style=\"text-align:right;\"> 2.3709 </td>\n   <td style=\"text-align:right;\"> -0.2528 </td>\n   <td style=\"text-align:right;\"> 0.8329 </td>\n   <td style=\"text-align:right;\"> 1.4290 </td>\n   <td style=\"text-align:right;\"> -0.8492 </td>\n   <td style=\"text-align:right;\"> 0.0128 </td>\n   <td style=\"text-align:right;\"> -0.0479 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3868 </td>\n   <td style=\"text-align:right;\"> -0.9290 </td>\n   <td style=\"text-align:right;\"> 0.6870 </td>\n   <td style=\"text-align:right;\"> -0.6117 </td>\n   <td style=\"text-align:right;\"> 1.5374 </td>\n   <td style=\"text-align:right;\"> -0.1113 </td>\n   <td style=\"text-align:right;\"> 0.2265 </td>\n   <td style=\"text-align:right;\"> 0.7691 </td>\n   <td style=\"text-align:right;\"> -0.8385 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -1.6767 </td>\n   <td style=\"text-align:right;\"> 0.2850 </td>\n   <td style=\"text-align:right;\"> -0.9842 </td>\n   <td style=\"text-align:right;\"> -1.8133 </td>\n   <td style=\"text-align:right;\"> -0.8136 </td>\n   <td style=\"text-align:right;\"> 0.7518 </td>\n   <td style=\"text-align:right;\"> 0.8450 </td>\n   <td style=\"text-align:right;\"> -0.2605 </td>\n   <td style=\"text-align:right;\"> 0.7893 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -0.7345 </td>\n   <td style=\"text-align:right;\"> -1.3222 </td>\n   <td style=\"text-align:right;\"> 0.3700 </td>\n   <td style=\"text-align:right;\"> -0.8448 </td>\n   <td style=\"text-align:right;\"> 2.0553 </td>\n   <td style=\"text-align:right;\"> -1.6018 </td>\n   <td style=\"text-align:right;\"> 0.7571 </td>\n   <td style=\"text-align:right;\"> -1.1866 </td>\n   <td style=\"text-align:right;\"> 1.6751 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.9393 </td>\n   <td style=\"text-align:right;\"> -0.6999 </td>\n   <td style=\"text-align:right;\"> -0.1399 </td>\n   <td style=\"text-align:right;\"> -0.5978 </td>\n   <td style=\"text-align:right;\"> -0.0203 </td>\n   <td style=\"text-align:right;\"> -0.0046 </td>\n   <td style=\"text-align:right;\"> 1.3170 </td>\n   <td style=\"text-align:right;\"> 0.4944 </td>\n   <td style=\"text-align:right;\"> 0.4746 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -0.8326 </td>\n   <td style=\"text-align:right;\"> 1.5874 </td>\n   <td style=\"text-align:right;\"> -0.7312 </td>\n   <td style=\"text-align:right;\"> 0.2910 </td>\n   <td style=\"text-align:right;\"> 0.1199 </td>\n   <td style=\"text-align:right;\"> 1.1100 </td>\n   <td style=\"text-align:right;\"> -1.6455 </td>\n   <td style=\"text-align:right;\"> 1.1312 </td>\n   <td style=\"text-align:right;\"> -0.0448 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.8725 </td>\n   <td style=\"text-align:right;\"> 1.0451 </td>\n   <td style=\"text-align:right;\"> 0.2775 </td>\n   <td style=\"text-align:right;\"> 0.2175 </td>\n   <td style=\"text-align:right;\"> -0.6226 </td>\n   <td style=\"text-align:right;\"> 0.5429 </td>\n   <td style=\"text-align:right;\"> -0.2118 </td>\n   <td style=\"text-align:right;\"> 0.9699 </td>\n   <td style=\"text-align:right;\"> 1.6165 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -2.7730 </td>\n   <td style=\"text-align:right;\"> 0.5328 </td>\n   <td style=\"text-align:right;\"> -0.3857 </td>\n   <td style=\"text-align:right;\"> -0.9341 </td>\n   <td style=\"text-align:right;\"> 0.8943 </td>\n   <td style=\"text-align:right;\"> -2.7237 </td>\n   <td style=\"text-align:right;\"> -0.4738 </td>\n   <td style=\"text-align:right;\"> -2.6266 </td>\n   <td style=\"text-align:right;\"> 1.1451 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2.0146 </td>\n   <td style=\"text-align:right;\"> 0.0014 </td>\n   <td style=\"text-align:right;\"> 0.6403 </td>\n   <td style=\"text-align:right;\"> -0.6929 </td>\n   <td style=\"text-align:right;\"> -0.1677 </td>\n   <td style=\"text-align:right;\"> 0.4555 </td>\n   <td style=\"text-align:right;\"> -0.3840 </td>\n   <td style=\"text-align:right;\"> 0.2754 </td>\n   <td style=\"text-align:right;\"> 1.0045 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -1.1376 </td>\n   <td style=\"text-align:right;\"> 0.6676 </td>\n   <td style=\"text-align:right;\"> 0.0612 </td>\n   <td style=\"text-align:right;\"> 0.2444 </td>\n   <td style=\"text-align:right;\"> -0.4465 </td>\n   <td style=\"text-align:right;\"> 0.9265 </td>\n   <td style=\"text-align:right;\"> -0.6966 </td>\n   <td style=\"text-align:right;\"> 0.9414 </td>\n   <td style=\"text-align:right;\"> 0.1757 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.1256 </td>\n   <td style=\"text-align:right;\"> -0.9951 </td>\n   <td style=\"text-align:right;\"> 1.1503 </td>\n   <td style=\"text-align:right;\"> -0.4897 </td>\n   <td style=\"text-align:right;\"> 0.7108 </td>\n   <td style=\"text-align:right;\"> 1.3854 </td>\n   <td style=\"text-align:right;\"> 0.0279 </td>\n   <td style=\"text-align:right;\"> -0.3615 </td>\n   <td style=\"text-align:right;\"> -0.4521 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -3.6486 </td>\n   <td style=\"text-align:right;\"> -5.1247 </td>\n   <td style=\"text-align:right;\"> 0.0491 </td>\n   <td style=\"text-align:right;\"> 6.3322 </td>\n   <td style=\"text-align:right;\"> -1.4438 </td>\n   <td style=\"text-align:right;\"> 1.4726 </td>\n   <td style=\"text-align:right;\"> -0.7719 </td>\n   <td style=\"text-align:right;\"> -0.9060 </td>\n   <td style=\"text-align:right;\"> 2.9209 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -0.3307 </td>\n   <td style=\"text-align:right;\"> 0.2793 </td>\n   <td style=\"text-align:right;\"> -0.0985 </td>\n   <td style=\"text-align:right;\"> -0.3388 </td>\n   <td style=\"text-align:right;\"> -0.5950 </td>\n   <td style=\"text-align:right;\"> -0.5761 </td>\n   <td style=\"text-align:right;\"> 2.0137 </td>\n   <td style=\"text-align:right;\"> 0.0524 </td>\n   <td style=\"text-align:right;\"> 0.9485 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -3.1386 </td>\n   <td style=\"text-align:right;\"> -2.4847 </td>\n   <td style=\"text-align:right;\"> -2.0044 </td>\n   <td style=\"text-align:right;\"> 1.0661 </td>\n   <td style=\"text-align:right;\"> -0.5877 </td>\n   <td style=\"text-align:right;\"> -0.0292 </td>\n   <td style=\"text-align:right;\"> -0.7689 </td>\n   <td style=\"text-align:right;\"> -0.0432 </td>\n   <td style=\"text-align:right;\"> -0.9302 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1.8304 </td>\n   <td style=\"text-align:right;\"> -0.8659 </td>\n   <td style=\"text-align:right;\"> -0.6292 </td>\n   <td style=\"text-align:right;\"> -0.2888 </td>\n   <td style=\"text-align:right;\"> -0.3585 </td>\n   <td style=\"text-align:right;\"> 1.1522 </td>\n   <td style=\"text-align:right;\"> 1.4099 </td>\n   <td style=\"text-align:right;\"> -0.2387 </td>\n   <td style=\"text-align:right;\"> 0.1117 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -2.6300 </td>\n   <td style=\"text-align:right;\"> 1.8820 </td>\n   <td style=\"text-align:right;\"> 1.4790 </td>\n   <td style=\"text-align:right;\"> 1.5197 </td>\n   <td style=\"text-align:right;\"> 0.1484 </td>\n   <td style=\"text-align:right;\"> 0.9943 </td>\n   <td style=\"text-align:right;\"> 1.0138 </td>\n   <td style=\"text-align:right;\"> 1.7547 </td>\n   <td style=\"text-align:right;\"> -0.2904 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -1.9654 </td>\n   <td style=\"text-align:right;\"> 1.4437 </td>\n   <td style=\"text-align:right;\"> 0.4239 </td>\n   <td style=\"text-align:right;\"> -1.4217 </td>\n   <td style=\"text-align:right;\"> 0.3452 </td>\n   <td style=\"text-align:right;\"> 0.1489 </td>\n   <td style=\"text-align:right;\"> 0.2267 </td>\n   <td style=\"text-align:right;\"> 0.8292 </td>\n   <td style=\"text-align:right;\"> 0.0537 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -2.9434 </td>\n   <td style=\"text-align:right;\"> -0.4453 </td>\n   <td style=\"text-align:right;\"> -0.1869 </td>\n   <td style=\"text-align:right;\"> 0.0501 </td>\n   <td style=\"text-align:right;\"> -0.3471 </td>\n   <td style=\"text-align:right;\"> -0.3884 </td>\n   <td style=\"text-align:right;\"> -1.8441 </td>\n   <td style=\"text-align:right;\"> 0.4520 </td>\n   <td style=\"text-align:right;\"> 0.3853 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1.9335 </td>\n   <td style=\"text-align:right;\"> 4.2274 </td>\n   <td style=\"text-align:right;\"> -1.5429 </td>\n   <td style=\"text-align:right;\"> -0.8354 </td>\n   <td style=\"text-align:right;\"> -0.5412 </td>\n   <td style=\"text-align:right;\"> 2.3739 </td>\n   <td style=\"text-align:right;\"> -0.2919 </td>\n   <td style=\"text-align:right;\"> 0.2478 </td>\n   <td style=\"text-align:right;\"> 0.0526 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -1.4611 </td>\n   <td style=\"text-align:right;\"> 0.5551 </td>\n   <td style=\"text-align:right;\"> -1.4467 </td>\n   <td style=\"text-align:right;\"> -0.2732 </td>\n   <td style=\"text-align:right;\"> 0.4168 </td>\n   <td style=\"text-align:right;\"> -0.3335 </td>\n   <td style=\"text-align:right;\"> 0.0306 </td>\n   <td style=\"text-align:right;\"> 1.0760 </td>\n   <td style=\"text-align:right;\"> -0.1292 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -1.6820 </td>\n   <td style=\"text-align:right;\"> -0.9253 </td>\n   <td style=\"text-align:right;\"> -0.3177 </td>\n   <td style=\"text-align:right;\"> -0.2737 </td>\n   <td style=\"text-align:right;\"> -0.7852 </td>\n   <td style=\"text-align:right;\"> 0.2036 </td>\n   <td style=\"text-align:right;\"> -0.4687 </td>\n   <td style=\"text-align:right;\"> 0.5302 </td>\n   <td style=\"text-align:right;\"> -0.4388 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 6.7595 </td>\n   <td style=\"text-align:right;\"> 3.6388 </td>\n   <td style=\"text-align:right;\"> 1.0562 </td>\n   <td style=\"text-align:right;\"> 2.3514 </td>\n   <td style=\"text-align:right;\"> 2.4970 </td>\n   <td style=\"text-align:right;\"> 3.4372 </td>\n   <td style=\"text-align:right;\"> -1.4276 </td>\n   <td style=\"text-align:right;\"> -3.6075 </td>\n   <td style=\"text-align:right;\"> -1.6018 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3.4507 </td>\n   <td style=\"text-align:right;\"> -1.1824 </td>\n   <td style=\"text-align:right;\"> 2.5699 </td>\n   <td style=\"text-align:right;\"> -1.1129 </td>\n   <td style=\"text-align:right;\"> -0.0546 </td>\n   <td style=\"text-align:right;\"> 1.4361 </td>\n   <td style=\"text-align:right;\"> -0.6591 </td>\n   <td style=\"text-align:right;\"> -1.0345 </td>\n   <td style=\"text-align:right;\"> -0.1605 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -1.0984 </td>\n   <td style=\"text-align:right;\"> -1.5241 </td>\n   <td style=\"text-align:right;\"> -0.5320 </td>\n   <td style=\"text-align:right;\"> -0.4777 </td>\n   <td style=\"text-align:right;\"> -0.9995 </td>\n   <td style=\"text-align:right;\"> -0.8030 </td>\n   <td style=\"text-align:right;\"> -0.1950 </td>\n   <td style=\"text-align:right;\"> -1.6084 </td>\n   <td style=\"text-align:right;\"> -0.6964 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -1.9193 </td>\n   <td style=\"text-align:right;\"> -0.0165 </td>\n   <td style=\"text-align:right;\"> -1.0806 </td>\n   <td style=\"text-align:right;\"> -0.5872 </td>\n   <td style=\"text-align:right;\"> -0.6324 </td>\n   <td style=\"text-align:right;\"> -0.2014 </td>\n   <td style=\"text-align:right;\"> -1.3158 </td>\n   <td style=\"text-align:right;\"> -1.3027 </td>\n   <td style=\"text-align:right;\"> 0.1718 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3.4962 </td>\n   <td style=\"text-align:right;\"> 1.5199 </td>\n   <td style=\"text-align:right;\"> 1.3109 </td>\n   <td style=\"text-align:right;\"> -0.3007 </td>\n   <td style=\"text-align:right;\"> 2.5985 </td>\n   <td style=\"text-align:right;\"> 1.0499 </td>\n   <td style=\"text-align:right;\"> -0.2313 </td>\n   <td style=\"text-align:right;\"> -0.0969 </td>\n   <td style=\"text-align:right;\"> 0.8464 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -0.2522 </td>\n   <td style=\"text-align:right;\"> 3.0718 </td>\n   <td style=\"text-align:right;\"> 2.1407 </td>\n   <td style=\"text-align:right;\"> -1.9255 </td>\n   <td style=\"text-align:right;\"> -2.2719 </td>\n   <td style=\"text-align:right;\"> -3.4093 </td>\n   <td style=\"text-align:right;\"> -2.1544 </td>\n   <td style=\"text-align:right;\"> 0.2271 </td>\n   <td style=\"text-align:right;\"> -1.2587 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -3.0135 </td>\n   <td style=\"text-align:right;\"> -0.6858 </td>\n   <td style=\"text-align:right;\"> -1.1712 </td>\n   <td style=\"text-align:right;\"> -0.8551 </td>\n   <td style=\"text-align:right;\"> -0.4428 </td>\n   <td style=\"text-align:right;\"> 0.8391 </td>\n   <td style=\"text-align:right;\"> -1.0039 </td>\n   <td style=\"text-align:right;\"> 0.4085 </td>\n   <td style=\"text-align:right;\"> -0.1121 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.3392 </td>\n   <td style=\"text-align:right;\"> -0.5133 </td>\n   <td style=\"text-align:right;\"> 0.0391 </td>\n   <td style=\"text-align:right;\"> -0.1766 </td>\n   <td style=\"text-align:right;\"> -0.5924 </td>\n   <td style=\"text-align:right;\"> 1.0593 </td>\n   <td style=\"text-align:right;\"> 1.1663 </td>\n   <td style=\"text-align:right;\"> 0.5207 </td>\n   <td style=\"text-align:right;\"> -0.3248 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -2.1136 </td>\n   <td style=\"text-align:right;\"> 2.6100 </td>\n   <td style=\"text-align:right;\"> 0.5330 </td>\n   <td style=\"text-align:right;\"> -0.8478 </td>\n   <td style=\"text-align:right;\"> 0.0752 </td>\n   <td style=\"text-align:right;\"> 0.1416 </td>\n   <td style=\"text-align:right;\"> 1.0927 </td>\n   <td style=\"text-align:right;\"> -0.3588 </td>\n   <td style=\"text-align:right;\"> 1.3478 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1.3707 </td>\n   <td style=\"text-align:right;\"> -2.9104 </td>\n   <td style=\"text-align:right;\"> 1.0848 </td>\n   <td style=\"text-align:right;\"> 1.3163 </td>\n   <td style=\"text-align:right;\"> 6.1381 </td>\n   <td style=\"text-align:right;\"> -2.1436 </td>\n   <td style=\"text-align:right;\"> 0.9717 </td>\n   <td style=\"text-align:right;\"> 0.1946 </td>\n   <td style=\"text-align:right;\"> -1.2873 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.0708 </td>\n   <td style=\"text-align:right;\"> -2.7257 </td>\n   <td style=\"text-align:right;\"> 0.4257 </td>\n   <td style=\"text-align:right;\"> -0.4752 </td>\n   <td style=\"text-align:right;\"> -0.7834 </td>\n   <td style=\"text-align:right;\"> 0.5789 </td>\n   <td style=\"text-align:right;\"> 0.9620 </td>\n   <td style=\"text-align:right;\"> 0.5196 </td>\n   <td style=\"text-align:right;\"> -0.2282 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -2.6465 </td>\n   <td style=\"text-align:right;\"> -0.3807 </td>\n   <td style=\"text-align:right;\"> -0.6944 </td>\n   <td style=\"text-align:right;\"> 1.0365 </td>\n   <td style=\"text-align:right;\"> -0.9202 </td>\n   <td style=\"text-align:right;\"> 0.4536 </td>\n   <td style=\"text-align:right;\"> 0.2146 </td>\n   <td style=\"text-align:right;\"> -0.6048 </td>\n   <td style=\"text-align:right;\"> -0.7532 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1.7505 </td>\n   <td style=\"text-align:right;\"> -0.1798 </td>\n   <td style=\"text-align:right;\"> -0.2689 </td>\n   <td style=\"text-align:right;\"> -0.3411 </td>\n   <td style=\"text-align:right;\"> 0.6075 </td>\n   <td style=\"text-align:right;\"> -0.7767 </td>\n   <td style=\"text-align:right;\"> -0.0058 </td>\n   <td style=\"text-align:right;\"> 0.2781 </td>\n   <td style=\"text-align:right;\"> 1.5233 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -3.3725 </td>\n   <td style=\"text-align:right;\"> 3.5365 </td>\n   <td style=\"text-align:right;\"> 5.3271 </td>\n   <td style=\"text-align:right;\"> 7.7627 </td>\n   <td style=\"text-align:right;\"> -2.3163 </td>\n   <td style=\"text-align:right;\"> -1.7961 </td>\n   <td style=\"text-align:right;\"> 2.1724 </td>\n   <td style=\"text-align:right;\"> -0.1875 </td>\n   <td style=\"text-align:right;\"> -1.1131 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -3.1242 </td>\n   <td style=\"text-align:right;\"> -1.0424 </td>\n   <td style=\"text-align:right;\"> 0.8044 </td>\n   <td style=\"text-align:right;\"> 2.1331 </td>\n   <td style=\"text-align:right;\"> 2.8559 </td>\n   <td style=\"text-align:right;\"> -0.9073 </td>\n   <td style=\"text-align:right;\"> -3.9502 </td>\n   <td style=\"text-align:right;\"> 3.0657 </td>\n   <td style=\"text-align:right;\"> -0.2529 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -1.0177 </td>\n   <td style=\"text-align:right;\"> -1.6718 </td>\n   <td style=\"text-align:right;\"> -1.8286 </td>\n   <td style=\"text-align:right;\"> 0.3950 </td>\n   <td style=\"text-align:right;\"> -0.4653 </td>\n   <td style=\"text-align:right;\"> 0.8616 </td>\n   <td style=\"text-align:right;\"> -0.2457 </td>\n   <td style=\"text-align:right;\"> -0.1711 </td>\n   <td style=\"text-align:right;\"> -0.3817 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -0.3396 </td>\n   <td style=\"text-align:right;\"> 0.7505 </td>\n   <td style=\"text-align:right;\"> 0.9596 </td>\n   <td style=\"text-align:right;\"> -0.3014 </td>\n   <td style=\"text-align:right;\"> 0.5726 </td>\n   <td style=\"text-align:right;\"> 0.0189 </td>\n   <td style=\"text-align:right;\"> -0.0433 </td>\n   <td style=\"text-align:right;\"> 0.0637 </td>\n   <td style=\"text-align:right;\"> 0.6271 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -2.2360 </td>\n   <td style=\"text-align:right;\"> -0.6559 </td>\n   <td style=\"text-align:right;\"> 0.7765 </td>\n   <td style=\"text-align:right;\"> 0.2318 </td>\n   <td style=\"text-align:right;\"> -0.2785 </td>\n   <td style=\"text-align:right;\"> -0.3448 </td>\n   <td style=\"text-align:right;\"> -0.0371 </td>\n   <td style=\"text-align:right;\"> 0.7968 </td>\n   <td style=\"text-align:right;\"> -1.0752 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> -3.1511 </td>\n   <td style=\"text-align:right;\"> 0.1807 </td>\n   <td style=\"text-align:right;\"> -1.0702 </td>\n   <td style=\"text-align:right;\"> -0.4912 </td>\n   <td style=\"text-align:right;\"> -0.2143 </td>\n   <td style=\"text-align:right;\"> -0.6257 </td>\n   <td style=\"text-align:right;\"> 0.7831 </td>\n   <td style=\"text-align:right;\"> -1.3442 </td>\n   <td style=\"text-align:right;\"> -1.6736 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Visualization\n\n### Scree Plot - Cumulative Variance Explained\n\n-   PC1 explains 40.8% variance.\n\n-   PC2 explains 9.5% variance.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_eig(data_pca, addlabels = TRUE)\n```\n\n::: {.cell-output-display}\n![](analysis_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n### Biplot\n\n-   The correlation between a variable and a principal component (PC) is used as the coordinates of the variable on the PC. The representation of variables differs from the plot of the observations: The observations are represented by their projections, but the variables are represented by their correlations @abdi2010principal.\n\n-   PC1 is represented in black which displays the longest distance of its projection.\n\n-   PC2 is represented in blue which displays a shorter distance as expected.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_pca_biplot(data_pca, \n                geom = c(\"point\", \"arrow\"),\n                geom.var = \"arrow\")\n```\n\n::: {.cell-output-display}\n![](analysis_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n### Correlation Circle\n\nThe plot below is also known as variable correlation plots. It shows the relationships between all variables. It can be interpreted as follow:\n\n-   Positively correlated variables are grouped together.\n\n-   Negatively correlated variables are positioned on opposite sides of the plot origin (opposed quadrants).\n\n-   The distance between variables and the origin measures the quality of the variables on the factor map. Variables that are away from the origin are well represented on the factor map.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Control variable colors using their contributions\nfviz_pca_var(data_pca, col.var = \"contrib\",\n   gradient.cols = c(\"white\", \"blue\", \"red\"),\n   geom.var = \"arrow\",\n   ggtheme = theme_minimal())\n```\n\n::: {.cell-output-display}\n![](analysis_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n### Variable Contribution\n\nTop variable contribution for the first two principal components.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Contributions of variables to PC1\npc2_contribution <- fviz_contrib(data_pca, choice = \"var\", axes = 1, top = 20)\n\n# Modify the theme to rotate X-axis labels to 90 degrees\npc2_contribution +\n  theme(\n    axis.text.x = element_text(angle = 0),\n    plot.title = element_text(hjust = 0)  # horizontal justification\n  ) +\n  coord_flip() +\n  labs(title = \"Contribution of Variables to PC1\",\n       y = \"Percentage Contribution\",\n       x = \"\",\n       caption = \"PC1 explains 40.8% variance\") +\n  scale_y_continuous(labels = scales::percent_format(scale = 1,\n                                                     accuracy = 1))\n```\n\n::: {.cell-output-display}\n![](analysis_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Contributions of variables to PC2\npc2_contribution <- fviz_contrib(data_pca, choice = \"var\", axes = 2, top = 12)\n\n# Modify the theme to rotate X-axis labels to 90 degrees\npc2_contribution +\n  theme(\n    axis.text.x = element_text(angle = 0),\n    plot.title = element_text(hjust = 0)  # horizontal justification\n  ) +\n  coord_flip() +\n  labs(title = \"Contribution of Variables to PC2\",\n       y = \"Percentage Contribution\",\n       x = \"\",\n       caption = \"PC2 explains 9.5% variance\") +\n  scale_y_continuous(labels = scales::percent_format(scale = 1,\n                                                     accuracy = 1))\n```\n\n::: {.cell-output-display}\n![](analysis_files/figure-html/unnamed-chunk-24-2.png){width=672}\n:::\n:::\n\n\n## Model Building\n\n### Data Splitting into Training & Test set\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# reproducible random sampling\nset.seed(my_seed)  \n \n# Create Target y-variable for the training set\ny <- train_data$expected_survival  \n# Split the data into training and test sets \nsplit <- sample.split(y, SplitRatio = 0.7) \ntraining_set <- subset(train_data, split == TRUE) \ntest_set <- subset(train_data, split == FALSE) \n```\n:::\n\n\n### Feature Scaling: Standardization\n\n-   Standardization ensures all features are on the same scale, and this method is less sensitive to outliers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Feature Scaling: Standardization\n# Perform centering and scaling on the training and test sets\nsc <- preProcess(training_set[, -target_index], \n                 method = c(\"center\", \"scale\"))\ntraining_set[, -target_index] <- predict(\n  sc, training_set[, -target_index])\ntest_set[, -target_index] <- predict(sc, test_set[, -target_index])\n```\n:::\n\n\n### Applying PCA to Training & Test sets\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Perform Principal Component Analysis (PCA) preprocessing on the training data\npca <- preProcess(training_set[, -target_index], \n                  method = 'pca', pcaComp = 8)\n\n# Apply PCA transformation to original training set\ntraining_set <- predict(pca, training_set)\n\n# Reorder columns, moving the dependent feature index to the end\ntraining_set <- training_set[c(2:9, 1)]\n\n# Apply PCA transformation to original test set\ntest_set <- predict(pca, test_set)\n\n# Reorder columns, moving the dependent feature index to the end\ntest_set <- test_set[c(2:9, 1)]\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n## PCA Full Model: 8 Principal Components\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# reproducible random sampling\nset.seed(my_seed)\n\n# Fit a multiple linear regression model\npca_full_model <- lm(expected_survival ~ ., data = training_set)\n\n# Print a summary of the regression model\ntab_model(pca_full_model, title = \"8 Principal Components Regression\",\n          string.p=\"P-value\", string.stat = \"T-score\",\n          string.se = \"Std. Error\",\n          string.resp = \"Response\",\n          string.ci = \"Conf Int.\",\n          show.se=T, show.stat = T,\n          CSS = list(\n             css.depvarhead = 'font-weight: bold; text-align: left;',\n             css.summary = 'color: #10759B; font-weight: bold;'\n           ))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<caption style=\"font-weight: bold; text-align:left;\">8 Principal Components Regression</caption>\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:italic; font-weight:normal; padding:0.2cm; border-bottom:1px solid black; text-align:left; \">&nbsp;</th>\n<th colspan=\"5\" style=\"border-top: double; text-align:center; font-style:italic; font-weight:normal; padding:0.2cm; border-bottom:1px solid black;\">expected_survival</th>\n</tr>\n<tr>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; text-align:left; \">Predictors</td>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; \">Estimates</td>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; \">Std. Error</td>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; \">Conf Int.</td>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; \">T-score</td>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; \">P-value</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">97.05</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.84</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">91.25&nbsp;&ndash;&nbsp;102.85</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">34.19</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">PC1</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">29.40</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.71</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">27.95&nbsp;&ndash;&nbsp;30.86</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">41.22</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">PC2</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">4.59</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.33</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.87&nbsp;&ndash;&nbsp;7.31</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.44</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.002</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">PC3</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.11</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.64</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;4.46&nbsp;&ndash;&nbsp;2.24</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.68</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.504</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">PC4</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">4.99</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.75</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.42&nbsp;&ndash;&nbsp;8.56</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.85</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.008</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">PC5</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;3.27</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.25</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;7.86&nbsp;&ndash;&nbsp;1.31</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.46</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.156</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">PC6</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">6.98</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.44</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.01&nbsp;&ndash;&nbsp;11.95</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.87</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.008</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">PC7</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;6.60</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.56</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;11.83&nbsp;&ndash;&nbsp;-1.37</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.58</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.015</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">PC8</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.80</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.82</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.96&nbsp;&ndash;&nbsp;9.56</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.35</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.188</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; color: #10759B; font-weight: bold; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; color: #10759B; font-weight: bold; text-align:center; border-top:1px solid;\" colspan=\"5\">39</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; color: #10759B; font-weight: bold;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; color: #10759B; font-weight: bold; text-align:center;\" colspan=\"5\">0.983 / 0.979</td>\n</tr>\n\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# Calculate PRESS\n# cat(\"PRESS: \", PRESS(pca_full_model), \"\\n\")\nPRESS_8pc <- PRESS(pca_full_model)\n# Calculate predicted R^2\n# cat(\"Predicted R^2: \", pred_r_squared(pca_full_model), \"\\n\")\nR2_8pcs <- pred_r_squared(pca_full_model)\n\npredict_8pc <- cbind(PRESS_8pc, R2_8pcs)\n# Print PRESS, predicted R^2\n# table format\nkbl(predict_8pc, caption = \"8 Principal Components Prediction Metrics\",\n    digits = 4) %>%\n  kable_paper(\"hover\", full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper lightable-hover\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n<caption>8 Principal Components Prediction Metrics</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> PRESS_8pc </th>\n   <th style=\"text-align:right;\"> R2_8pcs </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 31662.39 </td>\n   <td style=\"text-align:right;\"> 0.943 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Visualization of Uncorrelated PCA Matrix\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visual of Principal Components un-correlation\ncorr_matrix <- cor(training_set)\nggcorrplot(corr_matrix)\n```\n\n::: {.cell-output-display}\n![](analysis_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n## PCA: 2 Principal Components\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a subset with 2 principal components\nsignificant_pcs = c(1,2,9)\ntrain_pca <- training_set[, significant_pcs]\ntest_pca <- test_set[, significant_pcs]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# reproducible random sampling\nset.seed(my_seed)\n\n# Fit a multiple linear regression model\nreg_model <- lm(expected_survival ~ ., \n                data = train_pca)\n\n# Print a summary of the regression model\ntab_model(reg_model, title = \"2 Principal Components Regression\",\n          string.p=\"P-value\", string.stat = \"T-score\",\n          string.se = \"Std. Error\",\n          string.resp = \"Response\",\n          string.ci = \"Conf Int.\",\n          show.se=T, show.stat = T,\n          CSS = list(\n             css.depvarhead = 'font-weight: bold; text-align: left;',\n             css.summary = 'color: #10759B; font-weight: bold;'\n           ))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<caption style=\"font-weight: bold; text-align:left;\">2 Principal Components Regression</caption>\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:italic; font-weight:normal; padding:0.2cm; border-bottom:1px solid black; text-align:left; \">&nbsp;</th>\n<th colspan=\"5\" style=\"border-top: double; text-align:center; font-style:italic; font-weight:normal; padding:0.2cm; border-bottom:1px solid black;\">expected_survival</th>\n</tr>\n<tr>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; text-align:left; \">Predictors</td>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; \">Estimates</td>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; \">Std. Error</td>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; \">Conf Int.</td>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; \">T-score</td>\n<td style=\" font-weight: bold; text-align: left; border-bottom:1px solid black; \">P-value</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">97.05</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.58</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">89.78&nbsp;&ndash;&nbsp;104.32</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">27.07</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">PC1</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">29.40</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.90</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">27.58&nbsp;&ndash;&nbsp;31.23</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">32.64</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">PC2</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">4.59</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.68</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.18&nbsp;&ndash;&nbsp;8.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.73</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.010</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; color: #10759B; font-weight: bold; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; color: #10759B; font-weight: bold; text-align:center; border-top:1px solid;\" colspan=\"5\">39</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; color: #10759B; font-weight: bold;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; color: #10759B; font-weight: bold; text-align:center;\" colspan=\"5\">0.968 / 0.966</td>\n</tr>\n\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# Calculate PRESS\n# cat(\"PRESS: \", PRESS(reg_model), \"\\n\")\nPRESS_2pc <- PRESS(reg_model)\n\n# Calculate predicted R^2\n# cat(\"Predicted R^2: \", pred_r_squared(reg_model), \"\\n\")\nR2_2pc <- pred_r_squared(reg_model)\n\n# Print 2PC prediction results\npredict_2pc <- cbind(PRESS_2pc, R2_2pc)\n\n# table format\nkbl(predict_2pc, caption = \"2 Principal Components Prediction Metrics\",\n    digits = 4) %>%\n  kable_paper(\"hover\", full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper lightable-hover\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n<caption>2 Principal Components Prediction Metrics</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> PRESS_2pc </th>\n   <th style=\"text-align:right;\"> R2_2pc </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 25699.6 </td>\n   <td style=\"text-align:right;\"> 0.9538 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### **Principal Components Regression**\n\n-   PCA is used to calculate principal components that can then be used in principal components regression. This type of regression is often used when multicollinearity exists between predictors in a data set.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# reproducible random sampling\nset.seed(my_seed)\n\ny = train_pca$expected_survival\n\n# fit PCR\npcr_model <- pcr(y ~ PC1+PC2, data=train_pca, validation=\"CV\")\nprint(pcr_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPrincipal component regression, fitted with the singular value decomposition algorithm.\nCross-validated using 10 random segments.\nCall:\npcr(formula = y ~ PC1 + PC2, data = train_pca, validation = \"CV\")\n```\n:::\n\n```{.r .cell-code}\n# table format\n# kbl(pcr_model$residuals, caption = \"PCA Residuals\",\n#     digits = 4) %>%\n#   kable_paper(\"hover\", full_width = F)\n```\n:::\n\n\n### PCA: Cross-Validation Model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# reproducible random sampling\nset.seed(my_seed)\n\n# Cross-validation with n folds\nk_10 <- trainControl(method = \"cv\", number = 10)\n\n# training the model \nmodel_cv <- train(expected_survival ~ ., \n                  data = train_pca,\n                  method = \"lm\",\n                  trControl = k_10)\n\n# Print Model Performance\nprint(model_cv)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear Regression \n\n39 samples\n 2 predictor\n\nNo pre-processing\nResampling: Cross-Validated (10 fold) \nSummary of sample sizes: 35, 35, 35, 35, 35, 35, ... \nResampling results:\n\n  RMSE     Rsquared   MAE     \n  21.7825  0.9761582  16.14872\n\nTuning parameter 'intercept' was held constant at a value of TRUE\n```\n:::\n\n```{.r .cell-code}\n# Metrics\ncv_results = model_cv$results\nkbl(cv_results, caption = \"PCA: Cross-Validation Metrics\",\n    digits = 4) %>%\n  kable_paper(\"hover\", full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper lightable-hover\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n<caption>PCA: Cross-Validation Metrics</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> intercept </th>\n   <th style=\"text-align:right;\"> RMSE </th>\n   <th style=\"text-align:right;\"> Rsquared </th>\n   <th style=\"text-align:right;\"> MAE </th>\n   <th style=\"text-align:right;\"> RMSESD </th>\n   <th style=\"text-align:right;\"> RsquaredSD </th>\n   <th style=\"text-align:right;\"> MAESD </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> TRUE </td>\n   <td style=\"text-align:right;\"> 21.7825 </td>\n   <td style=\"text-align:right;\"> 0.9762 </td>\n   <td style=\"text-align:right;\"> 16.1487 </td>\n   <td style=\"text-align:right;\"> 14.0372 </td>\n   <td style=\"text-align:right;\"> 0.0377 </td>\n   <td style=\"text-align:right;\"> 8.5694 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Predictions\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Find the index position of the target feature\npred_target_index <- grep(target_name, \n                     colnames(test_pca))\n#cat(\"Target Feature Index =\", pred_target_index)\n\n# Create Predicted Target Feature (y-test) \ny_test <- test_pca[pred_target_index]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Predictions using the Cross-Validation model\ny_pred = predict(model_cv, newdata = test_pca[, -pred_target_index])\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Prediction Results from y_predictions\ny_pred <- round(y_pred, digits = 0)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Transform y_test from data frame to numeric\ny_test <- as.numeric(unlist(y_test))\n\nprediction_comparison <- cbind(y_pred, y_test)\n# table format\nkbl(prediction_comparison) %>%\n  kable_paper(\"hover\", full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper lightable-hover\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> y_pred </th>\n   <th style=\"text-align:right;\"> y_test </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 9 </td>\n   <td style=\"text-align:right;\"> 35 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 11 </td>\n   <td style=\"text-align:right;\"> 520 </td>\n   <td style=\"text-align:right;\"> 442 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 12 </td>\n   <td style=\"text-align:right;\"> 310 </td>\n   <td style=\"text-align:right;\"> 318 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 16 </td>\n   <td style=\"text-align:right;\"> 26 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 17 </td>\n   <td style=\"text-align:right;\"> 298 </td>\n   <td style=\"text-align:right;\"> 284 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 18 </td>\n   <td style=\"text-align:right;\"> 125 </td>\n   <td style=\"text-align:right;\"> 152 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 21 </td>\n   <td style=\"text-align:right;\"> 159 </td>\n   <td style=\"text-align:right;\"> 160 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 23 </td>\n   <td style=\"text-align:right;\"> 149 </td>\n   <td style=\"text-align:right;\"> 141 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 25 </td>\n   <td style=\"text-align:right;\"> 191 </td>\n   <td style=\"text-align:right;\"> 197 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 26 </td>\n   <td style=\"text-align:right;\"> 81 </td>\n   <td style=\"text-align:right;\"> 95 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 28 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 40 </td>\n   <td style=\"text-align:right;\"> 86 </td>\n   <td style=\"text-align:right;\"> 78 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 43 </td>\n   <td style=\"text-align:right;\"> 113 </td>\n   <td style=\"text-align:right;\"> 38 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 47 </td>\n   <td style=\"text-align:right;\"> 182 </td>\n   <td style=\"text-align:right;\"> 171 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 48 </td>\n   <td style=\"text-align:right;\"> 585 </td>\n   <td style=\"text-align:right;\"> 657 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 52 </td>\n   <td style=\"text-align:right;\"> 33 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 53 </td>\n   <td style=\"text-align:right;\"> 88 </td>\n   <td style=\"text-align:right;\"> 92 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Prediction Metrics\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate Mean Absolute Error (MAE)\nMAE_value <- mae(y_pred, y_test)\n#cat(\"MAE =\", mae_value)\n\n# Calculate MSE\nMSE_predict <- mean((y_pred - y_test)^2)\n#cat(\"\\nMSE =\", mse_predict)\n\n# Calculate RMSE\nRMSE_predict <- sqrt(mean((y_pred - y_test)^2))\n#cat(\"\\nRMSE =\", rmse_predict)\n\n# Calculate R-squared (R^2)\npredicted_R2 <- 1 - sum((y_test - y_pred)^2) / \n  sum((y_test - mean(y_test))^2)\n# cat(\"\\nPredicted R^2 =\", predicted_r2)\n\nprediction_metrics_df <- cbind(MAE_value, MSE_predict,\n                               RMSE_predict, predicted_R2)\n# table format\nkbl(prediction_metrics_df, digits = 4) %>%\n  kable_paper(\"hover\", full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper lightable-hover\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> MAE_value </th>\n   <th style=\"text-align:right;\"> MSE_predict </th>\n   <th style=\"text-align:right;\"> RMSE_predict </th>\n   <th style=\"text-align:right;\"> predicted_R2 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 21.8824 </td>\n   <td style=\"text-align:right;\"> 1142.235 </td>\n   <td style=\"text-align:right;\"> 33.797 </td>\n   <td style=\"text-align:right;\"> 0.96 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Training Conclusion\n\nIn conclusion, this project has demonstrated the effectiveness of Principal Component Analysis (PCA) in dimension reduction with the following key points:\n\n-   PCA was able to reduce from 37 features down to just 2 principal components.\n\n-   The best score of $R^2$ = 97.61% was from the Linear Regression with Cross-validation model.\n\n-   The predicted $R^2$ = 96%\n\n-   The average deviation between the predicted values, and observed values for 'Expected Survival' is RMSE = 33.8.\n\n-   The model has not been exposed to unseen data with a large amount of observations to asses its robustness, and reliability.\n\n",
    "supporting": [
      "analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}